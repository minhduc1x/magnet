# -*- coding: utf-8 -*-
"""
Created on Thu Sep 28 13:24:11 2017

@author: konicpa
"""

# -*- coding: utf-8 -*-
"""
Created on Fri Sep 22 11:22:15 2017

@author: konicpa
"""
#%%

import pandas as pd
import pandas.io.sql
import datetime as dt
from pandas.tseries.offsets import BDay
import time
from datetime import datetime, timedelta
import numpy as np
from pandas.tseries.offsets import CustomBusinessDay
from pandas.tseries.holiday import USFederalHolidayCalendar
from scipy import stats


ciqdb = pypyodbc.connect("DRIVER={SQL Server}; SERVER=MNDEVDB01\DEVMTTM; DATABASE=CompustatData", autocommit=True)

sql = """
set NOCOUNT ON

SELECT co.[companyId],[companyName],se.[securityId],[securityName],[securityStartDate],[securityEndDate],se.[securitySubTypeId],[securitySubTypeName],se.[primaryFlag],[tradingItemId],ti.[tickerSymbol],ti.[exchangeId],[currencyId],[tradingItemStatusId],ti.[primaryFlag],[companyStatusTypeId],[companyTypeId],co.[simpleIndustryId],[simpleIndustryDescription],[gvkey],[iid]
FROM [CompustatData].[dbo].[ciqCompany] co
left join [CompustatData].[dbo].[ciqSecurity] se on se.[companyId] = co.[companyId]
left join [CompustatData].[dbo].[ciqTradingItem] ti on ti.securityId = se.securityId
left join [CompustatData].[dbo].[ciqSimpleIndustry] si on si.[simpleIndustryId] = co.[simpleIndustryId]
left join [CompustatData].[dbo].[ciqSecuritySubType] st on st.[securitySubTypeId] = se.[securitySubTypeId]
left join [CompustatData].[dbo].[ciqGvkeyIID] gv on ti.[tradingItemId] = gv.[objectId]
where co.[companyId] in ((10004874),
(100058833),
(1002291),
(100231),
(1002357),
(10028455),
(10040674),
(1004106),
(100410633),
(100440),
(100489288),
(100537),
(1006484),
(100787816),
(10081196),
(100918),
(100934),
(100937),
(1011775),
(101992492),
(10214722),
(102169),
(102267652),
(102348),
(1027055),
(1032802),
(103284),
(103375),
(103518),
(103599),
(103678),
(1038312),
(1038325),
(1038327),
(1038355),
(1038362),
(1039587),
(10404838),
(1040657),
(104643),
(104673),
(10494135),
(1050056),
(1051325),
(105291345),
(105612),
(1057473),
(105768270),
(105841183),
(1059251),
(106335),
(1064020),
(106426),
(106437),
(106485352),
(106530929),
(106577),
(106636),
(1066957),
(106772),
(1067744),
(106987),
(10739227),
(107405),
(107633),
(10779727),
(107911),
(108253),
(108522),
(108544),
(108616),
(108839),
(108856),
(109103),
(109131),
(109136),
(109300),
(10969688),
(110001),
(110044279),
(110741),
(11113129),
(111314384),
(111358),
(11147204),
(111790273),
(11207402),
(112165),
(112302),
(112305),
(112350),
(113073),
(113131),
(113541117),
(11365458),
(113665065),
(11382658),
(113922672),
(113970207),
(114039),
(114063305),
(1141723),
(11420997),
(11478068),
(114823784),
(115032605),
(115102487),
(11515826),
(115779020),
(117842106),
(117912488),
(118218449),
(118315802),
(11857151),
(118605496),
(11888172),
(11902093),
(119033497),
(119902),
(120262),
(120285),
(120367),
(120406),
(120622),
(120623),
(120909),
(121238),
(121246),
(121483),
(121509),
(121534),
(121729),
(121767),
(122212),
(122699),
(122917),
(12296252),
(12297011),
(123217),
(12344550),
(123891),
(1239256),
(1241057),
(124219),
(124243),
(124307),
(124321),
(124423),
(124565),
(124878),
(12518001),
(125228),
(12534920),
(125757),
(1261061),
(126269),
(12633071),
(126362),
(126411),
(12666489),
(126668),
(126921),
(127095032),
(12719228),
(12722790),
(127583),
(127694719),
(127719),
(127881),
(127918),
(128209),
(12826523),
(128540),
(128584),
(128845270),
(129318),
(129396129),
(129679427),
(130258307),
(13061287),
(130689),
(130705),
(130863),
(13103664),
(131112810),
(131731858),
(13190293),
(132077212),
(133282),
(13356885),
(1340740),
(1340741),
(134106179),
(1341470),
(1341753),
(1342556),
(1342560),
(1343561),
(134603330),
(1348220),
(134992),
(13529856),
(13529992),
(135311),
(135443),
(135470),
(135474),
(13627017),
(136333),
(136356),
(13639172),
(136442),
(13649709),
(137240118),
(137304893),
(137411),
(137473239),
(13756315),
(13757558),
(137649125),
(138296738),
(138613332),
(139317925),
(139431),
(139488),
(139673),
(139677),
(139813),
(139997035),
(140233),
(140283),
(140950927),
(141108755),
(1413204),
(1413208),
(141581761),
(141827503),
(141885706),
(141930906),
(142250097),
(1425530),
(142670771),
(142879),
(142892259),
(144258),
(144405183),
(145116275),
(145625476),
(145737384),
(1458681),
(1462309),
(1494343),
(1495607),
(1519864),
(1528824),
(1533412),
(1534795),
(154054449),
(1541811),
(1543272),
(1543637),
(154924),
(155172),
(1565109),
(1566745),
(157028),
(1570880),
(1587862),
(159230),
(160077),
(160180),
(160197),
(160233),
(1611542),
(162270),
(163087),
(163111),
(164034),
(165298),
(166314),
(166457),
(1666001),
(166802),
(167945),
(168151),
(168154),
(168182),
(1683286),
(168569),
(168864),
(169142),
(169308),
(169838),
(1699197),
(170198295),
(170245760),
(170260),
(170352),
(170571),
(170928919),
(171106),
(171116),
(171445),
(171604),
(171649),
(171737),
(1717518),
(172055),
(172131),
(172207),
(172472),
(172899),
(173094),
(173341),
(173840),
(173927),
(174336),
(174438),
(174901),
(175110),
(175265),
(175480),
(1756150),
(175749),
(176102),
(176159),
(176787),
(177031),
(177126),
(177251),
(177500),
(177698),
(177934),
(178254),
(178296),
(178946),
(178976),
(1789909),
(1790684),
(179862),
(180871),
(181003),
(181176),
(181478),
(181943700),
(182505),
(182707),
(182949),
(183089),
(183811756),
(184128240),
(184157327),
(1843135),
(184841),
(184945),
(18527),
(185333),
(185508),
(185801),
(18671),
(186785),
(18749),
(1876050),
(188244),
(188335),
(188477),
(188653),
(189096),
(189282),
(189424),
(189426),
(189526),
(189539),
(189848),
(19007),
(190137),
(190268),
(190358),
(190489),
(190636),
(190694),
(190756),
(190786),
(190876),
(19095),
(190965),
(191013),
(191216),
(191328),
(191564),
(191884),
(192089),
(19209),
(192186),
(1921896),
(1925656),
(1944751),
(195901),
(19609),
(19691),
(1974492),
(197773),
(19839),
(199022),
(200128),
(200199),
(20119),
(203002),
(203101),
(204710830),
(20496676),
(20522974),
(20523038),
(205233),
(20531152),
(20571),
(20721550),
(207221),
(20801430),
(20963),
(2102034),
(210392),
(21127),
(21171),
(2125636),
(212766522),
(213048879),
(213879),
(214103601),
(2141734),
(215339359),
(215342183),
(215548781),
(21609),
(216313883),
(216581935),
(2168124),
(217389033),
(217503),
(21835),
(21842239),
(218812),
(21919911),
(219437),
(21954621),
(220168),
(22039608),
(22077696),
(22183895),
(22236226),
(22238416),
(222402013),
(222406786),
(22247),
(222554189),
(22261533),
(22298592),
(22357184),
(2238172),
(22385966),
(224003614),
(22413056),
(224325923),
(224946128),
(225078297),
(22511),
(22548461),
(225523981),
(22603885),
(22614982),
(226200263),
(226530250),
(226584812),
(22666093),
(226898),
(22691841),
(22747149),
(22751),
(22768589),
(22771433),
(22800180),
(22805),
(228070761),
(22848913),
(228755),
(22883846),
(22920207),
(22929077),
(22967487),
(23013),
(230297),
(23046303),
(23081173),
(2312985),
(231688165),
(231691952),
(232036063),
(232335127),
(23270929),
(23287),
(233427056),
(233582617),
(23374622),
(23499518),
(23500974),
(23553263),
(23557),
(23626080),
(23644436),
(23682136),
(23702309),
(237656125),
(23812789),
(23815047),
(2381717),
(23838378),
(238570),
(23873120),
(23939254),
(24003473),
(24043),
(240460878),
(2405489),
(240792646),
(24080914),
(240823191),
(24085),
(240936085),
(24114004),
(2413126),
(241463154),
(241494537),
(24154988),
(24165),
(241709041),
(241738548),
(241782379),
(24202),
(242099548),
(24225),
(24246),
(24249112),
(242798179),
(24281),
(24292),
(24321),
(24333),
(2433584),
(24362),
(243649654),
(24368),
(243685275),
(243685856),
(243907022),
(244370933),
(24442),
(24443077),
(244741443),
(24494),
(24504),
(24505),
(24522),
(245507),
(245786818),
(24603),
(24604),
(246100779),
(24620),
(246279126),
(246545),
(24658),
(246886),
(24689),
(247017859),
(247026262),
(24704),
(247170),
(247198),
(247261058),
(24732),
(247347),
(247371),
(24738407),
(247483),
(24753),
(247574887),
(24758),
(247593650),
(24766),
(24771),
(247782),
(24779),
(247842371),
(24801),
(24804),
(24809),
(2481334),
(24816),
(24821),
(248256),
(24827),
(248270),
(248356),
(2483732),
(24842),
(248450),
(24846),
(248501),
(248608),
(248655),
(24879),
(248823),
(248858755),
(24886525),
(248869),
(2488839),
(248916),
(24893),
(249061912),
(249110868),
(249126),
(249205),
(249319773),
(24937),
(249436),
(24950477),
(249603),
(24967),
(249726),
(24980220),
(249841),
(24985251),
(249925),
(24994),
(249999),
(250037),
(250079),
(25026),
(250312),
(250388),
(25039993),
(25046),
(250532),
(250592),
(25063),
(25080),
(250859),
(2508590),
(250885),
(25090458),
(25109),
(251230),
(251258),
(25134),
(251349),
(251411),
(251475),
(251704),
(251719973),
(251849),
(25191),
(252088241),
(252150),
(2522534),
(252257),
(252339),
(2523864),
(252431),
(252517),
(252551),
(252684),
(252743080),
(2527714),
(252978),
(253018),
(25304),
(25307),
(253076),
(253132),
(253239200),
(25334),
(253388),
(2534215),
(253561),
(2535666),
(253702),
(253706543),
(253730),
(25403751),
(254131),
(254193),
(254287707),
(25447),
(254497048),
(254571),
(25460099),
(254725),
(25478219),
(254847),
(25489),
(254965),
(255055),
(255132),
(255251),
(255397),
(255524),
(255627),
(2557009),
(25572071),
(255743),
(2557643),
(255781),
(255902),
(25605),
(256200),
(25643),
(256487722),
(256523),
(256558670),
(256689),
(25673),
(256839),
(256893),
(25708),
(257151),
(257198),
(257424),
(257568),
(257682),
(25776),
(25777),
(257948),
(25798),
(25812479),
(258133),
(25820),
(25823),
(258278),
(25836053),
(25839),
(258458),
(258532),
(258589),
(25864),
(258769),
(258791),
(258823),
(258891),
(258937),
(25910408),
(25915843),
(259212),
(25922),
(259280),
(25933),
(25935),
(259378),
(25941),
(259589),
(259731),
(25981),
(259829),
(259957),
(260119),
(26014489),
(260149),
(260291),
(260414),
(260583),
(260619),
(26069),
(260725),
(26079217),
(260824267),
(260858),
(260920),
(261084576),
(261105),
(261171),
(26145),
(26145318),
(261461504),
(261467539),
(26147908),
(261596),
(26161),
(261738),
(26175),
(261825),
(261915062),
(261974),
(262033),
(26207),
(262247),
(26238),
(26239),
(26252),
(26259736),
(262639),
(26268),
(26273),
(26274),
(262788142),
(262857074),
(262913),
(262937),
(262961),
(263093),
(26322),
(26323),
(263232),
(26325966),
(263295),
(263339),
(263424),
(26351024),
(263515824),
(263568),
(263587669),
(263609),
(263765),
(263774786),
(26394),
(264048),
(264239134),
(26433812),
(26453),
(26470411),
(264707946),
(264815),
(26486),
(264897),
(26524),
(265253),
(265539),
(26556501),
(265621),
(26565),
(266017),
(266099),
(266112),
(266238),
(266311),
(26633),
(26642),
(266430),
(266510),
(266598),
(266664),
(26674),
(266745628),
(266767),
(26677),
(266907),
(266974),
(267105),
(267161),
(267304112),
(267344),
(2673708),
(267468),
(267555),
(2675671),
(26765),
(267761),
(26782),
(267850),
(267906),
(268053),
(268141),
(268363),
(26837),
(268503),
(26879202),
(26879258),
(268799),
(26893),
(26906),
(26911),
(269231),
(269271),
(269306),
(26934),
(269599),
(269660),
(269706),
(269764),
(26977),
(26991845),
(269924),
(270315),
(270395),
(270427),
(27049995),
(270586),
(270700),
(270820),
(27098),
(271077),
(27111),
(27129),
(271305),
(271329),
(27133),
(271353957),
(27168),
(27189),
(27191),
(27198),
(27199),
(272054403),
(27222327),
(27223),
(27236),
(27244),
(27271),
(27292837),
(272957),
(27306532),
(27307),
(273212),
(273276),
(273513334),
(27351387),
(273607),
(273981),
(273983758),
(274031831),
(274166),
(274265),
(274350),
(27440804),
(274419),
(27444752),
(27447874),
(274561),
(27460),
(27465),
(274715),
(274818),
(27490),
(27504),
(27508),
(275119),
(275201),
(275232),
(27526391),
(275400),
(275442),
(275547611),
(275573),
(275668),
(275789),
(27582),
(276006),
(276060),
(276190901),
(276209),
(27629813),
(27645),
(27655),
(276599),
(27672),
(27681),
(27685),
(27707),
(277444),
(27745),
(277517),
(27755),
(277563183),
(277575),
(277603),
(277617),
(27763231),
(277709),
(277746),
(277824630),
(277854),
(277894),
(277914),
(277966),
(277994),
(278111),
(27812059),
(278143),
(278212),
(278271),
(278341),
(278369),
(2783831),
(27842),
(27844),
(278446),
(278513),
(278553),
(278556),
(278576),
(27860587),
(27862),
(278679),
(278733),
(278765),
(27877),
(279042),
(27910),
(279167),
(279306),
(279402278),
(279513),
(279534),
(27963),
(27970),
(27973340),
(279750),
(279954),
(280123),
(28014),
(280211),
(280274078),
(28028),
(280322),
(280420),
(28045),
(280561),
(28061),
(28062),
(28071),
(28071116),
(280856),
(280910),
(280944),
(281121),
(281314),
(281407),
(281438),
(28151),
(281820),
(281893),
(281931),
(282005),
(28202),
(28209),
(282225),
(282415),
(282503),
(282539),
(282576),
(28258),
(282590),
(28274),
(282848),
(28291),
(282981),
(283024),
(283234),
(283356),
(28338),
(283410),
(283484),
(283757),
(28381),
(283857),
(28395),
(284137),
(284342),
(28434822),
(28448),
(284564),
(284668),
(284766),
(28479),
(284847),
(285038),
(285125),
(285250),
(28532),
(285325),
(285467),
(2855282),
(285544),
(28556),
(28561473),
(28565),
(285663),
(285827),
(285880),
(285930),
(28606),
(28610038),
(286119),
(286163),
(286180590),
(286187),
(2862715),
(286358),
(286411),
(28646680),
(28671),
(286798),
(286976),
(287043),
(28723),
(28754),
(28756),
(28764),
(287798),
(287950),
(287993),
(288033),
(288195),
(288255),
(288355),
(288502),
(28872678),
(28877),
(288924),
(289030),
(289194),
(289484),
(289620),
(289834),
(29002),
(290060),
(290177),
(290203),
(29031),
(29053039),
(290650),
(290681),
(290733),
(290757),
(2908516),
(290898),
(29096),
(291225),
(291250),
(291286),
(291333),
(29142),
(291518),
(291586),
(291619),
(291703),
(291795),
(2918450),
(291981),
(29204),
(292092),
(292135),
(292268),
(29232),
(29243),
(29252427),
(292525),
(29256),
(29272),
(292742),
(29279),
(29282),
(292826),
(292980),
(293286),
(29344),
(29346),
(293515),
(293569),
(29364),
(293645),
(293680),
(293711),
(29374),
(293889),
(293966),
(294006),
(294167),
(294269),
(294338),
(294382),
(294483),
(294550),
(2945619),
(294639),
(29470),
(294721),
(294799),
(294945),
(294957),
(294994),
(295080),
(29515572),
(295170),
(295224),
(29538),
(295565),
(295624),
(295660),
(29574),
(295915),
(295969),
(296104),
(296129),
(29617),
(29618),
(296181),
(296308),
(296511),
(296527),
(296568),
(296799),
(29685),
(296889),
(296917),
(296957),
(297018),
(297179),
(297210),
(29726),
(29728),
(29729),
(297294),
(297384),
(297463012),
(297526),
(29753),
(297545),
(297620),
(29762552),
(297660),
(297799),
(29780),
(297850),
(29794),
(298014),
(29814932),
(298176),
(2982993),
(2983116),
(2983403),
(298400),
(298441),
(298482),
(298571),
(298753),
(298950),
(298968),
(29902),
(299095),
(299263),
(29929),
(299515),
(29962),
(29963),
(29969),
(299702),
(30000),
(30009227),
(30012),
(300504),
(30061),
(300644),
(300794),
(300942),
(301040),
(301069),
(30116),
(30116605),
(30120841),
(30133),
(301580992),
(301667),
(301669938),
(3017691),
(30177530),
(301891),
(301966),
(30202),
(30205),
(302143),
(30223),
(30232680),
(30244916),
(302480),
(30253),
(302594),
(302617),
(302707),
(3027333),
(3027743),
(302907),
(30292),
(30300),
(303104),
(30323),
(303303),
(30336380),
(303397),
(30345),
(303526),
(303591),
(303646),
(303689323),
(30379),
(303828),
(303885),
(303923),
(30396158),
(304124),
(304195),
(30421),
(30422),
(304227),
(304260),
(304284),
(304285),
(304383),
(30439),
(30451),
(30472),
(30485592),
(304977),
(30506),
(305082),
(30511),
(30513),
(305213),
(305467),
(30547),
(30550),
(305583),
(30573),
(305749),
(30575),
(30591),
(306013),
(306072),
(30613),
(306225),
(30643),
(306496),
(30655),
(306596),
(306688),
(306822),
(306963),
(307180),
(307265),
(30727),
(307375),
(307430),
(307501),
(30760),
(30763),
(30771),
(307782),
(307816),
(30785),
(307930),
(30795),
(30796),
(307982),
(308047),
(30820),
(308226),
(30822601),
(30823371),
(30834687),
(30839),
(308402),
(30843),
(308492871),
(308582),
(308587101),
(30860),
(308678),
(308806),
(308973),
(309122562),
(309162),
(309250887),
(309400),
(309456),
(309606),
(309681),
(309779),
(3097815),
(309845),
(30992759),
(309966),
(310076),
(310078),
(310240),
(310310),
(3103259),
(3103615),
(31046),
(31063165),
(310667),
(310736),
(310857479),
(3109188),
(310955),
(311239),
(311453),
(31148),
(31152),
(31153),
(311679),
(311760),
(3117990),
(311820),
(31186),
(31197),
(31217),
(312427),
(312648),
(31267),
(312769),
(312795578),
(31283),
(3128326),
(3128334),
(312949),
(313031),
(313055),
(313134),
(313220),
(31324),
(3132512),
(3133890),
(313393),
(313461),
(31348),
(313506),
(313509),
(31365),
(313734),
(313784),
(31380),
(31390),
(313947),
(314057),
(314312),
(314515),
(31463),
(314690),
(314750),
(31476),
(314842),
(314896),
(314960),
(31498),
(314995),
(31500),
(315117),
(315149),
(315210),
(315260),
(315394),
(3154614),
(315638543),
(315756),
(31577),
(31585),
(315884),
(3159732),
(316001),
(3160269),
(3163101),
(316367),
(31637),
(31670),
(316760073),
(316829),
(316877),
(3169998),
(317037),
(317227),
(31726),
(3173937),
(317519),
(317557),
(317627),
(317668),
(31772),
(317975),
(318049),
(318091),
(3181355),
(3182334),
(318505463),
(31864),
(318820),
(3188545),
(3188722),
(31900),
(319092),
(319157),
(319205),
(31926),
(319334),
(319384),
(319450),
(319532),
(319534),
(31973),
(3197334),
(3197361),
(3198565),
(3198633),
(3198786),
(3198815),
(320039344),
(320082),
(320105),
(32012),
(320141334),
(320186),
(320269),
(320303),
(320333),
(320371),
(32052),
(320570),
(32068),
(32073),
(320908),
(321180),
(321244),
(32137),
(321590),
(321778),
(32181),
(32184),
(322091),
(322121),
(32215),
(3222595),
(322298),
(322481),
(32265),
(322735),
(322777),
(322867),
(32290),
(32305),
(32307),
(323175),
(32352),
(323532),
(32356),
(323746),
(323756013),
(323857),
(32389646),
(32401),
(32410),
(324289),
(324452),
(32464),
(32471),
(32530),
(325333),
(32538),
(325428),
(32561),
(325619),
(325643),
(325771),
(32583),
(32588621),
(32590567),
(32596),
(32605),
(32638),
(326382),
(32657),
(326614),
(326838),
(327025),
(32710),
(32717),
(327291),
(327353),
(327408),
(327436),
(327460),
(3274917),
(32768),
(327735),
(327880),
(328190),
(32830),
(328377),
(32854),
(32855017),
(328571),
(328799),
(328874),
(32893341),
(3289679),
(32901),
(329083),
(329141),
(32919),
(329202),
(329287),
(32978),
(329891),
(329935),
(330043),
(330123),
(330170),
(330325),
(330453),
(330589),
(330661),
(33067),
(330672765),
(33080),
(331205),
(33127),
(331298),
(33130),
(331334),
(331476),
(331701),
(33174798),
(33180),
(33184),
(331949),
(332172),
(332250),
(332273),
(332311),
(332358),
(332476),
(332500),
(33254),
(332646),
(332700),
(332730),
(332954),
(33303923),
(333191),
(333273375),
(33328),
(333294),
(333332),
(333701),
(333765),
(333835),
(33384931),
(33386),
(333920),
(33398),
(33402796),
(33405327),
(334158),
(33420),
(334221),
(33424519),
(334367),
(33447962),
(334622),
(33493),
(335019),
(33509),
(33509757),
(33510148),
(33530),
(335306),
(33543),
(33560),
(33574),
(335798),
(335919),
(33593027),
(335973),
(336027),
(33604),
(336160),
(336277),
(33636),
(336458),
(336520),
(33679),
(33710),
(33715),
(337183),
(33764),
(33765),
(33769),
(337694),
(337708),
(33797),
(338018),
(33813),
(338134),
(33821),
(338214),
(338287),
(33832624),
(338403),
(338454),
(338513),
(338612),
(338729),
(33880),
(338943),
(33897),
(33926),
(339305),
(33931),
(339407),
(339447),
(339482),
(33950),
(33956),
(33982),
(339972),
(34001),
(340230),
(340272),
(34032),
(34039),
(340391),
(34048601),
(3405946),
(34067),
(34071),
(34071196),
(340736),
(34074951),
(34095687),
(341326),
(34138),
(341395),
(341530),
(341584),
(34177),
(341990),
(34219),
(34225),
(342453),
(34265589),
(34284),
(34306),
(343086),
(34335),
(34345),
(34378),
(343802),
(344112),
(344249),
(344284),
(344489),
(344562930),
(34490826),
(3449701),
(3451109),
(345779),
(34590),
(346012),
(346068),
(34611),
(346200),
(346270),
(346334),
(34640),
(346489),
(34682),
(34698),
(347035),
(34705),
(34709),
(347306),
(3473779),
(34740),
(34745),
(347535),
(347586),
(34765897),
(34768),
(3478354),
(347983),
(3479948),
(348016),
(34817),
(348238),
(348748),
(34874958),
(348788),
(34883),
(348835),
(348893),
(34917),
(34952431),
(34970103),
(349721),
(34990),
(34999),
(35000),
(35001),
(35003),
(35013),
(350153),
(350185),
(350318),
(350381),
(350405),
(350475),
(350503),
(350975),
(351162),
(352094),
(352350),
(35245481),
(35246128),
(35259),
(352620),
(352674),
(352769),
(352851),
(35298),
(353020),
(35303),
(353073),
(35312),
(353216),
(353253),
(35343499),
(353508),
(353867),
(35418),
(35426),
(35436),
(354361),
(35443),
(3545047),
(3547368),
(35475),
(35511785),
(355279),
(355432),
(355505),
(35576),
(355859),
(35600),
(35604),
(356133),
(35623987),
(356264),
(35631),
(3563798),
(35644),
(35647020),
(35648556),
(35650),
(35652),
(356618),
(356725),
(35695),
(356983),
(3572148),
(357301),
(35773),
(35806),
(35839),
(358694),
(3587084),
(35901),
(359017),
(3590733),
(35921712),
(35922),
(359339),
(35962803),
(359638),
(3596787),
(36005),
(36012134),
(360124),
(36013),
(36018),
(36033),
(36040),
(360416),
(3606161),
(36070),
(360791),
(36098),
(361068),
(361133),
(36122),
(361335),
(36146),
(361523),
(361617),
(361972),
(362000),
(36213),
(36214016),
(36216),
(36218),
(362220),
(36235),
(36265),
(362798),
(363003),
(363049),
(36318),
(363263),
(3632895),
(363597),
(363811),
(36398),
(364040),
(36437),
(36451),
(364700),
(364744),
(36476295),
(36478),
(3648194),
(36492),
(365013),
(36507),
(36508),
(365092),
(365114),
(365138),
(36536),
(365436),
(36551281),
(365997),
(36602),
(36610),
(3661558),
(36616),
(366230),
(36627),
(366314),
(36633475),
(36652),
(367118),
(36731),
(36762),
(367749),
(36776),
(36787),
(368278),
(368470),
(368607),
(36873737),
(368787),
(369346816),
(370017),
(370122),
(370413),
(370714),
(370857),
(371065),
(3711992),
(371281),
(371481),
(371856),
(372526),
(3732086),
(373264),
(3735944),
(373691),
(373702),
(374377),
(375780),
(37644463),
(376695),
(376921),
(376941),
(37709),
(377361),
(377732),
(3778171),
(377837),
(378088),
(378225),
(378537),
(378719),
(378755),
(378915),
(379037),
(379153),
(379493),
(379819),
(37995045),
(380011),
(38043467),
(38043973),
(380521),
(381068),
(381324),
(381591),
(381848),
(381997),
(382071),
(382127),
(382553),
(382724),
(383410),
(383754),
(384253),
(384381),
(384522),
(384639),
(384687),
(38572588),
(385872),
(385920),
(38610394),
(386225),
(386287),
(386289),
(386673),
(387097),
(387127),
(387513),
(387568),
(388397),
(388763),
(388819),
(38893720),
(389218),
(38933807),
(389726),
(390157),
(390225),
(391396),
(39153321),
(392731),
(392966),
(39348049),
(393488),
(393940),
(394038),
(394083),
(39413743),
(394466),
(394524),
(395442),
(39558105),
(395750),
(396177),
(396263),
(396353),
(397052),
(397072),
(397138),
(397414),
(397508),
(398144),
(398351),
(398549),
(398674),
(398784),
(399023),
(399117),
(399147),
(399217),
(399407),
(399462),
(399584),
(399700),
(399960),
(400224),
(400280),
(40084670),
(4008586),
(401541),
(401890),
(4026446),
(4027729),
(402971),
(402993),
(403719),
(404061),
(404105),
(404476),
(404682),
(40489588),
(405201),
(405257),
(405277),
(405465),
(405779),
(405869),
(406338),
(406606),
(406706),
(406896),
(407024),
(4080778),
(409424),
(410364),
(4107517),
(411220),
(411254),
(411342),
(411576),
(411950),
(411996),
(4120015),
(412052),
(412450),
(412632),
(413188),
(413190),
(413544),
(413831),
(413857),
(415352),
(4155690),
(415798),
(4161770),
(4163332),
(416404),
(4165287),
(41694753),
(417206),
(4180463),
(4182538),
(4184604),
(419781),
(4204488),
(4212820),
(4222231),
(422760),
(4233177),
(4235187),
(424556),
(424735),
(424885),
(4249970),
(4273768),
(42741660),
(42757816),
(4277008),
(4277141),
(4277236),
(4279240),
(4282491),
(4291896),
(4303924),
(4306112),
(4347554),
(43528096),
(435998),
(4368282),
(4368532),
(4370094),
(43960896),
(4420411),
(4422197),
(44459271),
(44709159),
(4481293),
(4485863),
(4492976),
(4497349),
(4497433),
(4508880),
(4528419),
(4544094),
(4567986),
(45987976),
(4613444),
(4640784),
(47054664),
(4730973),
(47371679),
(4741083),
(47411570),
(47531149),
(4773926),
(4800830),
(4803544),
(4860367),
(4876557),
(48809313),
(48853897),
(4890306),
(48933961),
(48993116),
(49276069),
(4932759),
(4940151),
(4993771),
(4997563),
(50206680),
(502751),
(5027624),
(5092377),
(51185930),
(515275),
(515923),
(517300),
(51738175),
(518638),
(518807),
(519411),
(520217),
(523176),
(526475),
(526573),
(526813),
(526921),
(526950),
(527252),
(527317),
(527364),
(527542),
(527596),
(527692),
(528325),
(528410),
(528414),
(528420),
(528955),
(53262489),
(5381745),
(5395961),
(5419323),
(5422066),
(5480744),
(5491205),
(553033),
(556909),
(5600655),
(588096),
(59036089),
(59049563),
(59151858),
(59220391),
(59503383),
(596117),
(598651),
(598666),
(598671),
(598689),
(598766),
(598808),
(6020983),
(6036497),
(603843),
(607483),
(61036),
(61177529),
(61199),
(61206100),
(61243),
(61292),
(6158729),
(61690445),
(617309),
(617490),
(61761808),
(6184168),
(6184525),
(618558),
(6186258),
(618908),
(61967803),
(619981),
(621806),
(621918),
(6227448),
(62541018),
(62670872),
(631759),
(6330458),
(642957),
(643621),
(6439171),
(645715),
(645776),
(6463398),
(6464151),
(6469353),
(6476441),
(6477196),
(6491293),
(655308),
(655542),
(655659),
(6565801),
(6569181),
(658507),
(658616),
(658767),
(6628356),
(66289856),
(6631173),
(664429),
(666631),
(6670721),
(675577),
(6757990),
(677376),
(677601),
(679139),
(679630),
(681029),
(682252),
(683720),
(6868151),
(687117),
(687140),
(687261),
(6886820),
(688713),
(6890373),
(689588),
(6904040),
(6908954),
(69189070),
(694640),
(695089),
(695204),
(695247),
(696281),
(696647),
(697701),
(7009878),
(701143),
(701179),
(704634),
(705287),
(705790),
(7131811),
(71456863),
(714668),
(715240),
(7195658),
(72526252),
(728889),
(731313),
(731580),
(734078),
(734865),
(738400),
(739115),
(739693),
(739698),
(742365),
(744526),
(745257),
(7471769),
(7489861),
(752915),
(754046),
(754881),
(7620997),
(7642030),
(7654173),
(7657914),
(765841),
(7662427),
(7665877),
(7666044),
(7668333),
(7670016),
(7675730),
(7683151),
(7685238),
(7704259),
(7731428),
(779331),
(7797659),
(780053),
(7818664),
(78749412),
(7910540),
(79161058),
(7918123),
(792424),
(79277661),
(794857),
(795040),
(7958431),
(7959935),
(8032784),
(805302),
(805585),
(8057672),
(8059421),
(8063879),
(8100663),
(810569),
(8122428),
(813573),
(813574),
(816889),
(819163),
(821389),
(82392972),
(8251223),
(8275373),
(8285048),
(831552),
(832494),
(838923),
(83920810),
(841205),
(841685),
(844756),
(854654),
(8591867),
(8610803),
(862598),
(862673),
(864032),
(873636),
(873641),
(873644),
(873648),
(873664),
(873695),
(873739),
(873742),
(873777),
(873792),
(873801),
(873804),
(873811),
(873813),
(873829),
(873832),
(873865),
(873874),
(873878),
(873897),
(873908),
(873917),
(873959),
(8740684),
(874078),
(874091),
(874125),
(874183),
(874190),
(874204),
(874249),
(874387),
(874480),
(874520),
(874645),
(874793),
(874827),
(874940),
(874988),
(875094),
(875120),
(875260),
(875334),
(875371),
(875453),
(875502),
(875568),
(875575),
(875612),
(875715),
(875838),
(875860),
(876006),
(876060),
(876067),
(876162),
(876199),
(876290),
(876323),
(876449),
(876577),
(876653),
(876661),
(876815),
(876861),
(877188),
(877270),
(877301),
(877535),
(877972),
(877990),
(878056),
(878093),
(878219),
(878373),
(878612),
(878615),
(879180),
(8793945),
(879555),
(879581),
(879730),
(879806),
(880059),
(880071),
(880193),
(880235),
(880251),
(880253),
(880287),
(880295),
(880311),
(880318),
(880393),
(880420),
(880494),
(880530),
(881094),
(881137),
(881155),
(881184),
(881203),
(881219),
(881300),
(881317),
(881367),
(881381),
(881409),
(881426),
(881430),
(881518),
(881624),
(882007),
(882041),
(882217),
(882318),
(882380),
(882569),
(882696),
(882767),
(882769),
(882794),
(882855),
(882937),
(882943),
(882950),
(883129),
(883197),
(8840403),
(884393),
(884401),
(887314),
(890498),
(89450),
(89538),
(896851),
(89809),
(9003256),
(9026347),
(90393),
(9051877),
(909408),
(91031),
(91092),
(91093),
(91192),
(915425),
(91675),
(91774),
(91797),
(9179990),
(91800),
(91823),
(91825),
(91868),
(92274),
(9247431),
(92578),
(92629),
(92639),
(92699),
(92716),
(92757),
(92768),
(9277653),
(92817),
(9282918),
(92852),
(92866),
(93024),
(93025),
(93026),
(93027),
(93028),
(93030),
(9306827),
(93196),
(93323),
(93339),
(93396),
(93425),
(93488),
(93547),
(93614),
(93624),
(93625),
(9363618),
(93904),
(94104),
(94188),
(94192),
(94197),
(94238),
(94243),
(94412),
(9444413),
(94613),
(94614),
(94728),
(94734),
(94799),
(94877),
(95153),
(95164),
(9525280),
(9532739),
(955392),
(955448),
(956269),
(95673),
(9573447),
(958929),
(9589732),
(95993),
(960673),
(96078),
(96079),
(96086),
(96161),
(9617257),
(9620336),
(96760),
(9681063),
(97023),
(97199),
(972115),
(972117),
(97423),
(9748502),
(97487),
(976038),
(97706),
(97928),
(97957),
(97965),
(981598),
(98186),
(98232368),
(983017),
(983307),
(98506),
(98509),
(98514),
(985438),
(98803),
(9885878),
(9885902),
(98873),
(98885),
(98924),
(9913586),
(9917384),
(99186),
(9956099),
(9962209),
(99856262),
(998579))
and st.[securitySubTypeId] = 1
and se.[primaryFlag] = 1
and ti.[primaryFlag] = 1
and [securityEndDate] is null
and gv.gvkey is not null and gv.iid is not null
"""

company = pandas.io.sql.read_sql(sql, ciqdb)
#%%                                
sql = """
set NOCOUNT ON

declare @dataItemId int
set @dataItemId = '4193' --1007 total assets
declare @evalDate datetime2
set @evalDate = dateadd(day,-1, cast(getdate() as date))

SELECT c.[companyId],gv.[gvkey],gv.[iid],s.[securityId],s.[primaryFlag]
,cast(fi.[periodEndDate] as date) as [periodEndDate]
,cast(fi.[filingDate] as date) as [filingDate],pt.[periodTypeName]
,fp.[calendarQuarter],fp.[calendarYear],fd.[dataItemId],di.[dataItemName],fd.[dataItemValue] 
FROM ciqCompany c 
JOIN [CompustatData].[dbo].[ciqSecurity] s on c.companyId = s.companyId 
JOIN [CompustatData].[dbo].[ciqTradingItem] ti on ti.securityId = s.securityId 
JOIN [CompustatData].[dbo].[ciqExchange] e on e.exchangeId = ti.exchangeId 
JOIN [CompustatData].[dbo].[ciqFinPeriod] fp on fp.companyId = c.companyId 
JOIN [CompustatData].[dbo].[ciqPeriodType] pt on pt.periodTypeId = fp.periodTypeId 
JOIN [CompustatData].[dbo].[ciqFinInstance] fi on fi.financialPeriodId = fp.financialPeriodId 
JOIN [CompustatData].[dbo].[ciqFinInstanceToCollection] ic on ic.financialInstanceId = fi.financialInstanceId 
JOIN [CompustatData].[dbo].[ciqFinCollection] fc on fc.financialCollectionId = ic.financialCollectionId 
JOIN [CompustatData].[dbo].[ciqFinCollectionData] fd on fd.financialCollectionId = ic.financialCollectionId 
JOIN [CompustatData].[dbo].[ciqDataItem] di on di.dataItemId = fd.dataItemId 
JOIN [CompustatData].[dbo].[ciqGvkeyIID] gv on ti.[tradingItemId] = gv.[objectId] 
WHERE fd.[dataItemId] = @dataItemId
--in (1002, 1001, 1008, 1004, 1007, 1009, 1276, 1006, 1275, 1013, 106) --= @dataItemId
AND fp.[periodTypeId] = 2		--quarterly 
AND fi.[restatementTypeId] = 2	--original
AND fi.[filingDate] between '1/1/05' and @evalDate 
AND c.[companyId] in ((10004874),
(100058833),
(1002291),
(100231),
(1002357),
(10028455),
(10040674),
(1004106),
(100410633),
(100440),
(100489288),
(100537),
(1006484),
(100787816),
(10081196),
(100918),
(100934),
(100937),
(1011775),
(101992492),
(10214722),
(102169),
(102267652),
(102348),
(1027055),
(1032802),
(103284),
(103375),
(103518),
(103599),
(103678),
(1038312),
(1038325),
(1038327),
(1038355),
(1038362),
(1039587),
(10404838),
(1040657),
(104643),
(104673),
(10494135),
(1050056),
(1051325),
(105291345),
(105612),
(1057473),
(105768270),
(105841183),
(1059251),
(106335),
(1064020),
(106426),
(106437),
(106485352),
(106530929),
(106577),
(106636),
(1066957),
(106772),
(1067744),
(106987),
(10739227),
(107405),
(107633),
(10779727),
(107911),
(108253),
(108522),
(108544),
(108616),
(108839),
(108856),
(109103),
(109131),
(109136),
(109300),
(10969688),
(110001),
(110044279),
(110741),
(11113129),
(111314384),
(111358),
(11147204),
(111790273),
(11207402),
(112165),
(112302),
(112305),
(112350),
(113073),
(113131),
(113541117),
(11365458),
(113665065),
(11382658),
(113922672),
(113970207),
(114039),
(114063305),
(1141723),
(11420997),
(11478068),
(114823784),
(115032605),
(115102487),
(11515826),
(115779020),
(117842106),
(117912488),
(118218449),
(118315802),
(11857151),
(118605496),
(11888172),
(11902093),
(119033497),
(119902),
(120262),
(120285),
(120367),
(120406),
(120622),
(120623),
(120909),
(121238),
(121246),
(121483),
(121509),
(121534),
(121729),
(121767),
(122212),
(122699),
(122917),
(12296252),
(12297011),
(123217),
(12344550),
(123891),
(1239256),
(1241057),
(124219),
(124243),
(124307),
(124321),
(124423),
(124565),
(124878),
(12518001),
(125228),
(12534920),
(125757),
(1261061),
(126269),
(12633071),
(126362),
(126411),
(12666489),
(126668),
(126921),
(127095032),
(12719228),
(12722790),
(127583),
(127694719),
(127719),
(127881),
(127918),
(128209),
(12826523),
(128540),
(128584),
(128845270),
(129318),
(129396129),
(129679427),
(130258307),
(13061287),
(130689),
(130705),
(130863),
(13103664),
(131112810),
(131731858),
(13190293),
(132077212),
(133282),
(13356885),
(1340740),
(1340741),
(134106179),
(1341470),
(1341753),
(1342556),
(1342560),
(1343561),
(134603330),
(1348220),
(134992),
(13529856),
(13529992),
(135311),
(135443),
(135470),
(135474),
(13627017),
(136333),
(136356),
(13639172),
(136442),
(13649709),
(137240118),
(137304893),
(137411),
(137473239),
(13756315),
(13757558),
(137649125),
(138296738),
(138613332),
(139317925),
(139431),
(139488),
(139673),
(139677),
(139813),
(139997035),
(140233),
(140283),
(140950927),
(141108755),
(1413204),
(1413208),
(141581761),
(141827503),
(141885706),
(141930906),
(142250097),
(1425530),
(142670771),
(142879),
(142892259),
(144258),
(144405183),
(145116275),
(145625476),
(145737384),
(1458681),
(1462309),
(1494343),
(1495607),
(1519864),
(1528824),
(1533412),
(1534795),
(154054449),
(1541811),
(1543272),
(1543637),
(154924),
(155172),
(1565109),
(1566745),
(157028),
(1570880),
(1587862),
(159230),
(160077),
(160180),
(160197),
(160233),
(1611542),
(162270),
(163087),
(163111),
(164034),
(165298),
(166314),
(166457),
(1666001),
(166802),
(167945),
(168151),
(168154),
(168182),
(1683286),
(168569),
(168864),
(169142),
(169308),
(169838),
(1699197),
(170198295),
(170245760),
(170260),
(170352),
(170571),
(170928919),
(171106),
(171116),
(171445),
(171604),
(171649),
(171737),
(1717518),
(172055),
(172131),
(172207),
(172472),
(172899),
(173094),
(173341),
(173840),
(173927),
(174336),
(174438),
(174901),
(175110),
(175265),
(175480),
(1756150),
(175749),
(176102),
(176159),
(176787),
(177031),
(177126),
(177251),
(177500),
(177698),
(177934),
(178254),
(178296),
(178946),
(178976),
(1789909),
(1790684),
(179862),
(180871),
(181003),
(181176),
(181478),
(181943700),
(182505),
(182707),
(182949),
(183089),
(183811756),
(184128240),
(184157327),
(1843135),
(184841),
(184945),
(18527),
(185333),
(185508),
(185801),
(18671),
(186785),
(18749),
(1876050),
(188244),
(188335),
(188477),
(188653),
(189096),
(189282),
(189424),
(189426),
(189526),
(189539),
(189848),
(19007),
(190137),
(190268),
(190358),
(190489),
(190636),
(190694),
(190756),
(190786),
(190876),
(19095),
(190965),
(191013),
(191216),
(191328),
(191564),
(191884),
(192089),
(19209),
(192186),
(1921896),
(1925656),
(1944751),
(195901),
(19609),
(19691),
(1974492),
(197773),
(19839),
(199022),
(200128),
(200199),
(20119),
(203002),
(203101),
(204710830),
(20496676),
(20522974),
(20523038),
(205233),
(20531152),
(20571),
(20721550),
(207221),
(20801430),
(20963),
(2102034),
(210392),
(21127),
(21171),
(2125636),
(212766522),
(213048879),
(213879),
(214103601),
(2141734),
(215339359),
(215342183),
(215548781),
(21609),
(216313883),
(216581935),
(2168124),
(217389033),
(217503),
(21835),
(21842239),
(218812),
(21919911),
(219437),
(21954621),
(220168),
(22039608),
(22077696),
(22183895),
(22236226),
(22238416),
(222402013),
(222406786),
(22247),
(222554189),
(22261533),
(22298592),
(22357184),
(2238172),
(22385966),
(224003614),
(22413056),
(224325923),
(224946128),
(225078297),
(22511),
(22548461),
(225523981),
(22603885),
(22614982),
(226200263),
(226530250),
(226584812),
(22666093),
(226898),
(22691841),
(22747149),
(22751),
(22768589),
(22771433),
(22800180),
(22805),
(228070761),
(22848913),
(228755),
(22883846),
(22920207),
(22929077),
(22967487),
(23013),
(230297),
(23046303),
(23081173),
(2312985),
(231688165),
(231691952),
(232036063),
(232335127),
(23270929),
(23287),
(233427056),
(233582617),
(23374622),
(23499518),
(23500974),
(23553263),
(23557),
(23626080),
(23644436),
(23682136),
(23702309),
(237656125),
(23812789),
(23815047),
(2381717),
(23838378),
(238570),
(23873120),
(23939254),
(24003473),
(24043),
(240460878),
(2405489),
(240792646),
(24080914),
(240823191),
(24085),
(240936085),
(24114004),
(2413126),
(241463154),
(241494537),
(24154988),
(24165),
(241709041),
(241738548),
(241782379),
(24202),
(242099548),
(24225),
(24246),
(24249112),
(242798179),
(24281),
(24292),
(24321),
(24333),
(2433584),
(24362),
(243649654),
(24368),
(243685275),
(243685856),
(243907022),
(244370933),
(24442),
(24443077),
(244741443),
(24494),
(24504),
(24505),
(24522),
(245507),
(245786818),
(24603),
(24604),
(246100779),
(24620),
(246279126),
(246545),
(24658),
(246886),
(24689),
(247017859),
(247026262),
(24704),
(247170),
(247198),
(247261058),
(24732),
(247347),
(247371),
(24738407),
(247483),
(24753),
(247574887),
(24758),
(247593650),
(24766),
(24771),
(247782),
(24779),
(247842371),
(24801),
(24804),
(24809),
(2481334),
(24816),
(24821),
(248256),
(24827),
(248270),
(248356),
(2483732),
(24842),
(248450),
(24846),
(248501),
(248608),
(248655),
(24879),
(248823),
(248858755),
(24886525),
(248869),
(2488839),
(248916),
(24893),
(249061912),
(249110868),
(249126),
(249205),
(249319773),
(24937),
(249436),
(24950477),
(249603),
(24967),
(249726),
(24980220),
(249841),
(24985251),
(249925),
(24994),
(249999),
(250037),
(250079),
(25026),
(250312),
(250388),
(25039993),
(25046),
(250532),
(250592),
(25063),
(25080),
(250859),
(2508590),
(250885),
(25090458),
(25109),
(251230),
(251258),
(25134),
(251349),
(251411),
(251475),
(251704),
(251719973),
(251849),
(25191),
(252088241),
(252150),
(2522534),
(252257),
(252339),
(2523864),
(252431),
(252517),
(252551),
(252684),
(252743080),
(2527714),
(252978),
(253018),
(25304),
(25307),
(253076),
(253132),
(253239200),
(25334),
(253388),
(2534215),
(253561),
(2535666),
(253702),
(253706543),
(253730),
(25403751),
(254131),
(254193),
(254287707),
(25447),
(254497048),
(254571),
(25460099),
(254725),
(25478219),
(254847),
(25489),
(254965),
(255055),
(255132),
(255251),
(255397),
(255524),
(255627),
(2557009),
(25572071),
(255743),
(2557643),
(255781),
(255902),
(25605),
(256200),
(25643),
(256487722),
(256523),
(256558670),
(256689),
(25673),
(256839),
(256893),
(25708),
(257151),
(257198),
(257424),
(257568),
(257682),
(25776),
(25777),
(257948),
(25798),
(25812479),
(258133),
(25820),
(25823),
(258278),
(25836053),
(25839),
(258458),
(258532),
(258589),
(25864),
(258769),
(258791),
(258823),
(258891),
(258937),
(25910408),
(25915843),
(259212),
(25922),
(259280),
(25933),
(25935),
(259378),
(25941),
(259589),
(259731),
(25981),
(259829),
(259957),
(260119),
(26014489),
(260149),
(260291),
(260414),
(260583),
(260619),
(26069),
(260725),
(26079217),
(260824267),
(260858),
(260920),
(261084576),
(261105),
(261171),
(26145),
(26145318),
(261461504),
(261467539),
(26147908),
(261596),
(26161),
(261738),
(26175),
(261825),
(261915062),
(261974),
(262033),
(26207),
(262247),
(26238),
(26239),
(26252),
(26259736),
(262639),
(26268),
(26273),
(26274),
(262788142),
(262857074),
(262913),
(262937),
(262961),
(263093),
(26322),
(26323),
(263232),
(26325966),
(263295),
(263339),
(263424),
(26351024),
(263515824),
(263568),
(263587669),
(263609),
(263765),
(263774786),
(26394),
(264048),
(264239134),
(26433812),
(26453),
(26470411),
(264707946),
(264815),
(26486),
(264897),
(26524),
(265253),
(265539),
(26556501),
(265621),
(26565),
(266017),
(266099),
(266112),
(266238),
(266311),
(26633),
(26642),
(266430),
(266510),
(266598),
(266664),
(26674),
(266745628),
(266767),
(26677),
(266907),
(266974),
(267105),
(267161),
(267304112),
(267344),
(2673708),
(267468),
(267555),
(2675671),
(26765),
(267761),
(26782),
(267850),
(267906),
(268053),
(268141),
(268363),
(26837),
(268503),
(26879202),
(26879258),
(268799),
(26893),
(26906),
(26911),
(269231),
(269271),
(269306),
(26934),
(269599),
(269660),
(269706),
(269764),
(26977),
(26991845),
(269924),
(270315),
(270395),
(270427),
(27049995),
(270586),
(270700),
(270820),
(27098),
(271077),
(27111),
(27129),
(271305),
(271329),
(27133),
(271353957),
(27168),
(27189),
(27191),
(27198),
(27199),
(272054403),
(27222327),
(27223),
(27236),
(27244),
(27271),
(27292837),
(272957),
(27306532),
(27307),
(273212),
(273276),
(273513334),
(27351387),
(273607),
(273981),
(273983758),
(274031831),
(274166),
(274265),
(274350),
(27440804),
(274419),
(27444752),
(27447874),
(274561),
(27460),
(27465),
(274715),
(274818),
(27490),
(27504),
(27508),
(275119),
(275201),
(275232),
(27526391),
(275400),
(275442),
(275547611),
(275573),
(275668),
(275789),
(27582),
(276006),
(276060),
(276190901),
(276209),
(27629813),
(27645),
(27655),
(276599),
(27672),
(27681),
(27685),
(27707),
(277444),
(27745),
(277517),
(27755),
(277563183),
(277575),
(277603),
(277617),
(27763231),
(277709),
(277746),
(277824630),
(277854),
(277894),
(277914),
(277966),
(277994),
(278111),
(27812059),
(278143),
(278212),
(278271),
(278341),
(278369),
(2783831),
(27842),
(27844),
(278446),
(278513),
(278553),
(278556),
(278576),
(27860587),
(27862),
(278679),
(278733),
(278765),
(27877),
(279042),
(27910),
(279167),
(279306),
(279402278),
(279513),
(279534),
(27963),
(27970),
(27973340),
(279750),
(279954),
(280123),
(28014),
(280211),
(280274078),
(28028),
(280322),
(280420),
(28045),
(280561),
(28061),
(28062),
(28071),
(28071116),
(280856),
(280910),
(280944),
(281121),
(281314),
(281407),
(281438),
(28151),
(281820),
(281893),
(281931),
(282005),
(28202),
(28209),
(282225),
(282415),
(282503),
(282539),
(282576),
(28258),
(282590),
(28274),
(282848),
(28291),
(282981),
(283024),
(283234),
(283356),
(28338),
(283410),
(283484),
(283757),
(28381),
(283857),
(28395),
(284137),
(284342),
(28434822),
(28448),
(284564),
(284668),
(284766),
(28479),
(284847),
(285038),
(285125),
(285250),
(28532),
(285325),
(285467),
(2855282),
(285544),
(28556),
(28561473),
(28565),
(285663),
(285827),
(285880),
(285930),
(28606),
(28610038),
(286119),
(286163),
(286180590),
(286187),
(2862715),
(286358),
(286411),
(28646680),
(28671),
(286798),
(286976),
(287043),
(28723),
(28754),
(28756),
(28764),
(287798),
(287950),
(287993),
(288033),
(288195),
(288255),
(288355),
(288502),
(28872678),
(28877),
(288924),
(289030),
(289194),
(289484),
(289620),
(289834),
(29002),
(290060),
(290177),
(290203),
(29031),
(29053039),
(290650),
(290681),
(290733),
(290757),
(2908516),
(290898),
(29096),
(291225),
(291250),
(291286),
(291333),
(29142),
(291518),
(291586),
(291619),
(291703),
(291795),
(2918450),
(291981),
(29204),
(292092),
(292135),
(292268),
(29232),
(29243),
(29252427),
(292525),
(29256),
(29272),
(292742),
(29279),
(29282),
(292826),
(292980),
(293286),
(29344),
(29346),
(293515),
(293569),
(29364),
(293645),
(293680),
(293711),
(29374),
(293889),
(293966),
(294006),
(294167),
(294269),
(294338),
(294382),
(294483),
(294550),
(2945619),
(294639),
(29470),
(294721),
(294799),
(294945),
(294957),
(294994),
(295080),
(29515572),
(295170),
(295224),
(29538),
(295565),
(295624),
(295660),
(29574),
(295915),
(295969),
(296104),
(296129),
(29617),
(29618),
(296181),
(296308),
(296511),
(296527),
(296568),
(296799),
(29685),
(296889),
(296917),
(296957),
(297018),
(297179),
(297210),
(29726),
(29728),
(29729),
(297294),
(297384),
(297463012),
(297526),
(29753),
(297545),
(297620),
(29762552),
(297660),
(297799),
(29780),
(297850),
(29794),
(298014),
(29814932),
(298176),
(2982993),
(2983116),
(2983403),
(298400),
(298441),
(298482),
(298571),
(298753),
(298950),
(298968),
(29902),
(299095),
(299263),
(29929),
(299515),
(29962),
(29963),
(29969),
(299702),
(30000),
(30009227),
(30012),
(300504),
(30061),
(300644),
(300794),
(300942),
(301040),
(301069),
(30116),
(30116605),
(30120841),
(30133),
(301580992),
(301667),
(301669938),
(3017691),
(30177530),
(301891),
(301966),
(30202),
(30205),
(302143),
(30223),
(30232680),
(30244916),
(302480),
(30253),
(302594),
(302617),
(302707),
(3027333),
(3027743),
(302907),
(30292),
(30300),
(303104),
(30323),
(303303),
(30336380),
(303397),
(30345),
(303526),
(303591),
(303646),
(303689323),
(30379),
(303828),
(303885),
(303923),
(30396158),
(304124),
(304195),
(30421),
(30422),
(304227),
(304260),
(304284),
(304285),
(304383),
(30439),
(30451),
(30472),
(30485592),
(304977),
(30506),
(305082),
(30511),
(30513),
(305213),
(305467),
(30547),
(30550),
(305583),
(30573),
(305749),
(30575),
(30591),
(306013),
(306072),
(30613),
(306225),
(30643),
(306496),
(30655),
(306596),
(306688),
(306822),
(306963),
(307180),
(307265),
(30727),
(307375),
(307430),
(307501),
(30760),
(30763),
(30771),
(307782),
(307816),
(30785),
(307930),
(30795),
(30796),
(307982),
(308047),
(30820),
(308226),
(30822601),
(30823371),
(30834687),
(30839),
(308402),
(30843),
(308492871),
(308582),
(308587101),
(30860),
(308678),
(308806),
(308973),
(309122562),
(309162),
(309250887),
(309400),
(309456),
(309606),
(309681),
(309779),
(3097815),
(309845),
(30992759),
(309966),
(310076),
(310078),
(310240),
(310310),
(3103259),
(3103615),
(31046),
(31063165),
(310667),
(310736),
(310857479),
(3109188),
(310955),
(311239),
(311453),
(31148),
(31152),
(31153),
(311679),
(311760),
(3117990),
(311820),
(31186),
(31197),
(31217),
(312427),
(312648),
(31267),
(312769),
(312795578),
(31283),
(3128326),
(3128334),
(312949),
(313031),
(313055),
(313134),
(313220),
(31324),
(3132512),
(3133890),
(313393),
(313461),
(31348),
(313506),
(313509),
(31365),
(313734),
(313784),
(31380),
(31390),
(313947),
(314057),
(314312),
(314515),
(31463),
(314690),
(314750),
(31476),
(314842),
(314896),
(314960),
(31498),
(314995),
(31500),
(315117),
(315149),
(315210),
(315260),
(315394),
(3154614),
(315638543),
(315756),
(31577),
(31585),
(315884),
(3159732),
(316001),
(3160269),
(3163101),
(316367),
(31637),
(31670),
(316760073),
(316829),
(316877),
(3169998),
(317037),
(317227),
(31726),
(3173937),
(317519),
(317557),
(317627),
(317668),
(31772),
(317975),
(318049),
(318091),
(3181355),
(3182334),
(318505463),
(31864),
(318820),
(3188545),
(3188722),
(31900),
(319092),
(319157),
(319205),
(31926),
(319334),
(319384),
(319450),
(319532),
(319534),
(31973),
(3197334),
(3197361),
(3198565),
(3198633),
(3198786),
(3198815),
(320039344),
(320082),
(320105),
(32012),
(320141334),
(320186),
(320269),
(320303),
(320333),
(320371),
(32052),
(320570),
(32068),
(32073),
(320908),
(321180),
(321244),
(32137),
(321590),
(321778),
(32181),
(32184),
(322091),
(322121),
(32215),
(3222595),
(322298),
(322481),
(32265),
(322735),
(322777),
(322867),
(32290),
(32305),
(32307),
(323175),
(32352),
(323532),
(32356),
(323746),
(323756013),
(323857),
(32389646),
(32401),
(32410),
(324289),
(324452),
(32464),
(32471),
(32530),
(325333),
(32538),
(325428),
(32561),
(325619),
(325643),
(325771),
(32583),
(32588621),
(32590567),
(32596),
(32605),
(32638),
(326382),
(32657),
(326614),
(326838),
(327025),
(32710),
(32717),
(327291),
(327353),
(327408),
(327436),
(327460),
(3274917),
(32768),
(327735),
(327880),
(328190),
(32830),
(328377),
(32854),
(32855017),
(328571),
(328799),
(328874),
(32893341),
(3289679),
(32901),
(329083),
(329141),
(32919),
(329202),
(329287),
(32978),
(329891),
(329935),
(330043),
(330123),
(330170),
(330325),
(330453),
(330589),
(330661),
(33067),
(330672765),
(33080),
(331205),
(33127),
(331298),
(33130),
(331334),
(331476),
(331701),
(33174798),
(33180),
(33184),
(331949),
(332172),
(332250),
(332273),
(332311),
(332358),
(332476),
(332500),
(33254),
(332646),
(332700),
(332730),
(332954),
(33303923),
(333191),
(333273375),
(33328),
(333294),
(333332),
(333701),
(333765),
(333835),
(33384931),
(33386),
(333920),
(33398),
(33402796),
(33405327),
(334158),
(33420),
(334221),
(33424519),
(334367),
(33447962),
(334622),
(33493),
(335019),
(33509),
(33509757),
(33510148),
(33530),
(335306),
(33543),
(33560),
(33574),
(335798),
(335919),
(33593027),
(335973),
(336027),
(33604),
(336160),
(336277),
(33636),
(336458),
(336520),
(33679),
(33710),
(33715),
(337183),
(33764),
(33765),
(33769),
(337694),
(337708),
(33797),
(338018),
(33813),
(338134),
(33821),
(338214),
(338287),
(33832624),
(338403),
(338454),
(338513),
(338612),
(338729),
(33880),
(338943),
(33897),
(33926),
(339305),
(33931),
(339407),
(339447),
(339482),
(33950),
(33956),
(33982),
(339972),
(34001),
(340230),
(340272),
(34032),
(34039),
(340391),
(34048601),
(3405946),
(34067),
(34071),
(34071196),
(340736),
(34074951),
(34095687),
(341326),
(34138),
(341395),
(341530),
(341584),
(34177),
(341990),
(34219),
(34225),
(342453),
(34265589),
(34284),
(34306),
(343086),
(34335),
(34345),
(34378),
(343802),
(344112),
(344249),
(344284),
(344489),
(344562930),
(34490826),
(3449701),
(3451109),
(345779),
(34590),
(346012),
(346068),
(34611),
(346200),
(346270),
(346334),
(34640),
(346489),
(34682),
(34698),
(347035),
(34705),
(34709),
(347306),
(3473779),
(34740),
(34745),
(347535),
(347586),
(34765897),
(34768),
(3478354),
(347983),
(3479948),
(348016),
(34817),
(348238),
(348748),
(34874958),
(348788),
(34883),
(348835),
(348893),
(34917),
(34952431),
(34970103),
(349721),
(34990),
(34999),
(35000),
(35001),
(35003),
(35013),
(350153),
(350185),
(350318),
(350381),
(350405),
(350475),
(350503),
(350975),
(351162),
(352094),
(352350),
(35245481),
(35246128),
(35259),
(352620),
(352674),
(352769),
(352851),
(35298),
(353020),
(35303),
(353073),
(35312),
(353216),
(353253),
(35343499),
(353508),
(353867),
(35418),
(35426),
(35436),
(354361),
(35443),
(3545047),
(3547368),
(35475),
(35511785),
(355279),
(355432),
(355505),
(35576),
(355859),
(35600),
(35604),
(356133),
(35623987),
(356264),
(35631),
(3563798),
(35644),
(35647020),
(35648556),
(35650),
(35652),
(356618),
(356725),
(35695),
(356983),
(3572148),
(357301),
(35773),
(35806),
(35839),
(358694),
(3587084),
(35901),
(359017),
(3590733),
(35921712),
(35922),
(359339),
(35962803),
(359638),
(3596787),
(36005),
(36012134),
(360124),
(36013),
(36018),
(36033),
(36040),
(360416),
(3606161),
(36070),
(360791),
(36098),
(361068),
(361133),
(36122),
(361335),
(36146),
(361523),
(361617),
(361972),
(362000),
(36213),
(36214016),
(36216),
(36218),
(362220),
(36235),
(36265),
(362798),
(363003),
(363049),
(36318),
(363263),
(3632895),
(363597),
(363811),
(36398),
(364040),
(36437),
(36451),
(364700),
(364744),
(36476295),
(36478),
(3648194),
(36492),
(365013),
(36507),
(36508),
(365092),
(365114),
(365138),
(36536),
(365436),
(36551281),
(365997),
(36602),
(36610),
(3661558),
(36616),
(366230),
(36627),
(366314),
(36633475),
(36652),
(367118),
(36731),
(36762),
(367749),
(36776),
(36787),
(368278),
(368470),
(368607),
(36873737),
(368787),
(369346816),
(370017),
(370122),
(370413),
(370714),
(370857),
(371065),
(3711992),
(371281),
(371481),
(371856),
(372526),
(3732086),
(373264),
(3735944),
(373691),
(373702),
(374377),
(375780),
(37644463),
(376695),
(376921),
(376941),
(37709),
(377361),
(377732),
(3778171),
(377837),
(378088),
(378225),
(378537),
(378719),
(378755),
(378915),
(379037),
(379153),
(379493),
(379819),
(37995045),
(380011),
(38043467),
(38043973),
(380521),
(381068),
(381324),
(381591),
(381848),
(381997),
(382071),
(382127),
(382553),
(382724),
(383410),
(383754),
(384253),
(384381),
(384522),
(384639),
(384687),
(38572588),
(385872),
(385920),
(38610394),
(386225),
(386287),
(386289),
(386673),
(387097),
(387127),
(387513),
(387568),
(388397),
(388763),
(388819),
(38893720),
(389218),
(38933807),
(389726),
(390157),
(390225),
(391396),
(39153321),
(392731),
(392966),
(39348049),
(393488),
(393940),
(394038),
(394083),
(39413743),
(394466),
(394524),
(395442),
(39558105),
(395750),
(396177),
(396263),
(396353),
(397052),
(397072),
(397138),
(397414),
(397508),
(398144),
(398351),
(398549),
(398674),
(398784),
(399023),
(399117),
(399147),
(399217),
(399407),
(399462),
(399584),
(399700),
(399960),
(400224),
(400280),
(40084670),
(4008586),
(401541),
(401890),
(4026446),
(4027729),
(402971),
(402993),
(403719),
(404061),
(404105),
(404476),
(404682),
(40489588),
(405201),
(405257),
(405277),
(405465),
(405779),
(405869),
(406338),
(406606),
(406706),
(406896),
(407024),
(4080778),
(409424),
(410364),
(4107517),
(411220),
(411254),
(411342),
(411576),
(411950),
(411996),
(4120015),
(412052),
(412450),
(412632),
(413188),
(413190),
(413544),
(413831),
(413857),
(415352),
(4155690),
(415798),
(4161770),
(4163332),
(416404),
(4165287),
(41694753),
(417206),
(4180463),
(4182538),
(4184604),
(419781),
(4204488),
(4212820),
(4222231),
(422760),
(4233177),
(4235187),
(424556),
(424735),
(424885),
(4249970),
(4273768),
(42741660),
(42757816),
(4277008),
(4277141),
(4277236),
(4279240),
(4282491),
(4291896),
(4303924),
(4306112),
(4347554),
(43528096),
(435998),
(4368282),
(4368532),
(4370094),
(43960896),
(4420411),
(4422197),
(44459271),
(44709159),
(4481293),
(4485863),
(4492976),
(4497349),
(4497433),
(4508880),
(4528419),
(4544094),
(4567986),
(45987976),
(4613444),
(4640784),
(47054664),
(4730973),
(47371679),
(4741083),
(47411570),
(47531149),
(4773926),
(4800830),
(4803544),
(4860367),
(4876557),
(48809313),
(48853897),
(4890306),
(48933961),
(48993116),
(49276069),
(4932759),
(4940151),
(4993771),
(4997563),
(50206680),
(502751),
(5027624),
(5092377),
(51185930),
(515275),
(515923),
(517300),
(51738175),
(518638),
(518807),
(519411),
(520217),
(523176),
(526475),
(526573),
(526813),
(526921),
(526950),
(527252),
(527317),
(527364),
(527542),
(527596),
(527692),
(528325),
(528410),
(528414),
(528420),
(528955),
(53262489),
(5381745),
(5395961),
(5419323),
(5422066),
(5480744),
(5491205),
(553033),
(556909),
(5600655),
(588096),
(59036089),
(59049563),
(59151858),
(59220391),
(59503383),
(596117),
(598651),
(598666),
(598671),
(598689),
(598766),
(598808),
(6020983),
(6036497),
(603843),
(607483),
(61036),
(61177529),
(61199),
(61206100),
(61243),
(61292),
(6158729),
(61690445),
(617309),
(617490),
(61761808),
(6184168),
(6184525),
(618558),
(6186258),
(618908),
(61967803),
(619981),
(621806),
(621918),
(6227448),
(62541018),
(62670872),
(631759),
(6330458),
(642957),
(643621),
(6439171),
(645715),
(645776),
(6463398),
(6464151),
(6469353),
(6476441),
(6477196),
(6491293),
(655308),
(655542),
(655659),
(6565801),
(6569181),
(658507),
(658616),
(658767),
(6628356),
(66289856),
(6631173),
(664429),
(666631),
(6670721),
(675577),
(6757990),
(677376),
(677601),
(679139),
(679630),
(681029),
(682252),
(683720),
(6868151),
(687117),
(687140),
(687261),
(6886820),
(688713),
(6890373),
(689588),
(6904040),
(6908954),
(69189070),
(694640),
(695089),
(695204),
(695247),
(696281),
(696647),
(697701),
(7009878),
(701143),
(701179),
(704634),
(705287),
(705790),
(7131811),
(71456863),
(714668),
(715240),
(7195658),
(72526252),
(728889),
(731313),
(731580),
(734078),
(734865),
(738400),
(739115),
(739693),
(739698),
(742365),
(744526),
(745257),
(7471769),
(7489861),
(752915),
(754046),
(754881),
(7620997),
(7642030),
(7654173),
(7657914),
(765841),
(7662427),
(7665877),
(7666044),
(7668333),
(7670016),
(7675730),
(7683151),
(7685238),
(7704259),
(7731428),
(779331),
(7797659),
(780053),
(7818664),
(78749412),
(7910540),
(79161058),
(7918123),
(792424),
(79277661),
(794857),
(795040),
(7958431),
(7959935),
(8032784),
(805302),
(805585),
(8057672),
(8059421),
(8063879),
(8100663),
(810569),
(8122428),
(813573),
(813574),
(816889),
(819163),
(821389),
(82392972),
(8251223),
(8275373),
(8285048),
(831552),
(832494),
(838923),
(83920810),
(841205),
(841685),
(844756),
(854654),
(8591867),
(8610803),
(862598),
(862673),
(864032),
(873636),
(873641),
(873644),
(873648),
(873664),
(873695),
(873739),
(873742),
(873777),
(873792),
(873801),
(873804),
(873811),
(873813),
(873829),
(873832),
(873865),
(873874),
(873878),
(873897),
(873908),
(873917),
(873959),
(8740684),
(874078),
(874091),
(874125),
(874183),
(874190),
(874204),
(874249),
(874387),
(874480),
(874520),
(874645),
(874793),
(874827),
(874940),
(874988),
(875094),
(875120),
(875260),
(875334),
(875371),
(875453),
(875502),
(875568),
(875575),
(875612),
(875715),
(875838),
(875860),
(876006),
(876060),
(876067),
(876162),
(876199),
(876290),
(876323),
(876449),
(876577),
(876653),
(876661),
(876815),
(876861),
(877188),
(877270),
(877301),
(877535),
(877972),
(877990),
(878056),
(878093),
(878219),
(878373),
(878612),
(878615),
(879180),
(8793945),
(879555),
(879581),
(879730),
(879806),
(880059),
(880071),
(880193),
(880235),
(880251),
(880253),
(880287),
(880295),
(880311),
(880318),
(880393),
(880420),
(880494),
(880530),
(881094),
(881137),
(881155),
(881184),
(881203),
(881219),
(881300),
(881317),
(881367),
(881381),
(881409),
(881426),
(881430),
(881518),
(881624),
(882007),
(882041),
(882217),
(882318),
(882380),
(882569),
(882696),
(882767),
(882769),
(882794),
(882855),
(882937),
(882943),
(882950),
(883129),
(883197),
(8840403),
(884393),
(884401),
(887314),
(890498),
(89450),
(89538),
(896851),
(89809),
(9003256),
(9026347),
(90393),
(9051877),
(909408),
(91031),
(91092),
(91093),
(91192),
(915425),
(91675),
(91774),
(91797),
(9179990),
(91800),
(91823),
(91825),
(91868),
(92274),
(9247431),
(92578),
(92629),
(92639),
(92699),
(92716),
(92757),
(92768),
(9277653),
(92817),
(9282918),
(92852),
(92866),
(93024),
(93025),
(93026),
(93027),
(93028),
(93030),
(9306827),
(93196),
(93323),
(93339),
(93396),
(93425),
(93488),
(93547),
(93614),
(93624),
(93625),
(9363618),
(93904),
(94104),
(94188),
(94192),
(94197),
(94238),
(94243),
(94412),
(9444413),
(94613),
(94614),
(94728),
(94734),
(94799),
(94877),
(95153),
(95164),
(9525280),
(9532739),
(955392),
(955448),
(956269),
(95673),
(9573447),
(958929),
(9589732),
(95993),
(960673),
(96078),
(96079),
(96086),
(96161),
(9617257),
(9620336),
(96760),
(9681063),
(97023),
(97199),
(972115),
(972117),
(97423),
(9748502),
(97487),
(976038),
(97706),
(97928),
(97957),
(97965),
(981598),
(98186),
(98232368),
(983017),
(983307),
(98506),
(98509),
(98514),
(985438),
(98803),
(9885878),
(9885902),
(98873),
(98885),
(98924),
(9913586),
(9917384),
(99186),
(9956099),
(9962209),
(99856262),
(998579))
and s.primaryFlag = 1
--and se.primaryFlag = 1
and gv.[iid] in ('01')
ORDER BY fd.[dataItemId],gv.[gvkey],fi.[periodEndDate]
"""

fund = pandas.io.sql.read_sql(sql, ciqdb)
fund = fund.set_index(['companyid'])
#%%

sql = """
set NOCOUNT ON

declare @companyList table (companyId int)
insert into @companyList values
(10004874),
(100058833),
(1002291),
(100231),
(1002357),
(10028455),
(10040674),
(1004106),
(100410633),
(100440),
(100489288),
(100537),
(1006484),
(100787816),
(10081196),
(100918),
(100934),
(100937),
(1011775),
(101992492),
(10214722),
(102169),
(102267652),
(102348),
(1027055),
(1032802),
(103284),
(103375),
(103518),
(103599),
(103678),
(1038312),
(1038325),
(1038327),
(1038355),
(1038362),
(1039587),
(10404838),
(1040657),
(104643),
(104673),
(10494135),
(1050056),
(1051325),
(105291345),
(105612),
(1057473),
(105768270),
(105841183),
(1059251),
(106335),
(1064020),
(106426),
(106437),
(106485352),
(106530929),
(106577),
(106636),
(1066957),
(106772),
(1067744),
(106987),
(10739227),
(107405),
(107633),
(10779727),
(107911),
(108253),
(108522),
(108544),
(108616),
(108839),
(108856),
(109103),
(109131),
(109136),
(109300),
(10969688),
(110001),
(110044279),
(110741),
(11113129),
(111314384),
(111358),
(11147204),
(111790273),
(11207402),
(112165),
(112302),
(112305),
(112350),
(113073),
(113131),
(113541117),
(11365458),
(113665065),
(11382658),
(113922672),
(113970207),
(114039),
(114063305),
(1141723),
(11420997),
(11478068),
(114823784),
(115032605),
(115102487),
(11515826),
(115779020),
(117842106),
(117912488),
(118218449),
(118315802),
(11857151),
(118605496),
(11888172),
(11902093),
(119033497),
(119902),
(120262),
(120285),
(120367),
(120406),
(120622),
(120623),
(120909),
(121238),
(121246),
(121483),
(121509),
(121534),
(121729),
(121767),
(122212),
(122699),
(122917),
(12296252),
(12297011),
(123217),
(12344550),
(123891),
(1239256),
(1241057),
(124219),
(124243),
(124307),
(124321),
(124423),
(124565),
(124878),
(12518001),
(125228),
(12534920),
(125757),
(1261061),
(126269),
(12633071),
(126362),
(126411),
(12666489),
(126668),
(126921),
(127095032),
(12719228),
(12722790),
(127583),
(127694719),
(127719),
(127881),
(127918),
(128209),
(12826523),
(128540),
(128584),
(128845270),
(129318),
(129396129),
(129679427),
(130258307),
(13061287),
(130689),
(130705),
(130863),
(13103664),
(131112810),
(131731858),
(13190293),
(132077212),
(133282),
(13356885),
(1340740),
(1340741),
(134106179),
(1341470),
(1341753),
(1342556),
(1342560),
(1343561),
(134603330),
(1348220),
(134992),
(13529856),
(13529992),
(135311),
(135443),
(135470),
(135474),
(13627017),
(136333),
(136356),
(13639172),
(136442),
(13649709),
(137240118),
(137304893),
(137411),
(137473239),
(13756315),
(13757558),
(137649125),
(138296738),
(138613332),
(139317925),
(139431),
(139488),
(139673),
(139677),
(139813),
(139997035),
(140233),
(140283),
(140950927),
(141108755),
(1413204),
(1413208),
(141581761),
(141827503),
(141885706),
(141930906),
(142250097),
(1425530),
(142670771),
(142879),
(142892259),
(144258),
(144405183),
(145116275),
(145625476),
(145737384),
(1458681),
(1462309),
(1494343),
(1495607),
(1519864),
(1528824),
(1533412),
(1534795),
(154054449),
(1541811),
(1543272),
(1543637),
(154924),
(155172),
(1565109),
(1566745),
(157028),
(1570880),
(1587862),
(159230),
(160077),
(160180),
(160197),
(160233),
(1611542),
(162270),
(163087),
(163111),
(164034),
(165298),
(166314),
(166457),
(1666001),
(166802),
(167945),
(168151),
(168154),
(168182),
(1683286),
(168569),
(168864),
(169142),
(169308),
(169838),
(1699197),
(170198295),
(170245760),
(170260),
(170352),
(170571),
(170928919),
(171106),
(171116),
(171445),
(171604),
(171649),
(171737),
(1717518),
(172055),
(172131),
(172207),
(172472),
(172899),
(173094),
(173341),
(173840),
(173927),
(174336),
(174438),
(174901),
(175110),
(175265),
(175480),
(1756150),
(175749),
(176102),
(176159),
(176787),
(177031),
(177126),
(177251),
(177500),
(177698),
(177934),
(178254),
(178296),
(178946),
(178976),
(1789909),
(1790684),
(179862),
(180871),
(181003),
(181176),
(181478),
(181943700),
(182505),
(182707),
(182949),
(183089),
(183811756),
(184128240),
(184157327),
(1843135),
(184841),
(184945),
(18527),
(185333),
(185508),
(185801),
(18671),
(186785),
(18749),
(1876050),
(188244),
(188335),
(188477),
(188653),
(189096),
(189282),
(189424),
(189426),
(189526),
(189539),
(189848),
(19007),
(190137),
(190268),
(190358),
(190489),
(190636),
(190694),
(190756),
(190786),
(190876),
(19095),
(190965),
(191013),
(191216),
(191328),
(191564),
(191884),
(192089),
(19209),
(192186),
(1921896),
(1925656),
(1944751),
(195901),
(19609),
(19691),
(1974492),
(197773),
(19839),
(199022),
(200128),
(200199),
(20119),
(203002),
(203101),
(204710830),
(20496676),
(20522974),
(20523038),
(205233),
(20531152),
(20571),
(20721550),
(207221),
(20801430),
(20963),
(2102034),
(210392),
(21127),
(21171),
(2125636),
(212766522),
(213048879),
(213879),
(214103601),
(2141734),
(215339359),
(215342183),
(215548781),
(21609),
(216313883),
(216581935),
(2168124),
(217389033),
(217503),
(21835),
(21842239),
(218812),
(21919911),
(219437),
(21954621),
(220168),
(22039608),
(22077696),
(22183895),
(22236226),
(22238416),
(222402013),
(222406786),
(22247),
(222554189),
(22261533),
(22298592),
(22357184),
(2238172),
(22385966),
(224003614),
(22413056),
(224325923),
(224946128),
(225078297),
(22511),
(22548461),
(225523981),
(22603885),
(22614982),
(226200263),
(226530250),
(226584812),
(22666093),
(226898),
(22691841),
(22747149),
(22751),
(22768589),
(22771433),
(22800180),
(22805),
(228070761),
(22848913),
(228755),
(22883846),
(22920207),
(22929077),
(22967487),
(23013),
(230297),
(23046303),
(23081173),
(2312985),
(231688165),
(231691952),
(232036063),
(232335127),
(23270929),
(23287),
(233427056),
(233582617),
(23374622),
(23499518),
(23500974),
(23553263),
(23557),
(23626080),
(23644436),
(23682136),
(23702309),
(237656125),
(23812789),
(23815047),
(2381717),
(23838378),
(238570),
(23873120),
(23939254),
(24003473),
(24043),
(240460878),
(2405489),
(240792646),
(24080914),
(240823191),
(24085),
(240936085),
(24114004),
(2413126),
(241463154),
(241494537),
(24154988),
(24165),
(241709041),
(241738548),
(241782379),
(24202),
(242099548),
(24225),
(24246),
(24249112),
(242798179),
(24281),
(24292),
(24321),
(24333),
(2433584),
(24362),
(243649654),
(24368),
(243685275),
(243685856),
(243907022),
(244370933),
(24442),
(24443077),
(244741443),
(24494),
(24504),
(24505),
(24522),
(245507),
(245786818),
(24603),
(24604),
(246100779),
(24620),
(246279126),
(246545),
(24658),
(246886),
(24689),
(247017859),
(247026262),
(24704),
(247170),
(247198),
(247261058),
(24732),
(247347),
(247371),
(24738407),
(247483),
(24753),
(247574887),
(24758),
(247593650),
(24766),
(24771),
(247782),
(24779),
(247842371),
(24801),
(24804),
(24809),
(2481334),
(24816),
(24821),
(248256),
(24827),
(248270),
(248356),
(2483732),
(24842),
(248450),
(24846),
(248501),
(248608),
(248655),
(24879),
(248823),
(248858755),
(24886525),
(248869),
(2488839),
(248916),
(24893),
(249061912),
(249110868),
(249126),
(249205),
(249319773),
(24937),
(249436),
(24950477),
(249603),
(24967),
(249726),
(24980220),
(249841),
(24985251),
(249925),
(24994),
(249999),
(250037),
(250079),
(25026),
(250312),
(250388),
(25039993),
(25046),
(250532),
(250592),
(25063),
(25080),
(250859),
(2508590),
(250885),
(25090458),
(25109),
(251230),
(251258),
(25134),
(251349),
(251411),
(251475),
(251704),
(251719973),
(251849),
(25191),
(252088241),
(252150),
(2522534),
(252257),
(252339),
(2523864),
(252431),
(252517),
(252551),
(252684),
(252743080),
(2527714),
(252978),
(253018),
(25304),
(25307),
(253076),
(253132),
(253239200),
(25334),
(253388),
(2534215),
(253561),
(2535666),
(253702),
(253706543),
(253730),
(25403751),
(254131),
(254193),
(254287707),
(25447),
(254497048),
(254571),
(25460099),
(254725),
(25478219),
(254847),
(25489),
(254965),
(255055),
(255132),
(255251),
(255397),
(255524),
(255627),
(2557009),
(25572071),
(255743),
(2557643),
(255781),
(255902),
(25605),
(256200),
(25643),
(256487722),
(256523),
(256558670),
(256689),
(25673),
(256839),
(256893),
(25708),
(257151),
(257198),
(257424),
(257568),
(257682),
(25776),
(25777),
(257948),
(25798),
(25812479),
(258133),
(25820),
(25823),
(258278),
(25836053),
(25839),
(258458),
(258532),
(258589),
(25864),
(258769),
(258791),
(258823),
(258891),
(258937),
(25910408),
(25915843),
(259212),
(25922),
(259280),
(25933),
(25935),
(259378),
(25941),
(259589),
(259731),
(25981),
(259829),
(259957),
(260119),
(26014489),
(260149),
(260291),
(260414),
(260583),
(260619),
(26069),
(260725),
(26079217),
(260824267),
(260858),
(260920),
(261084576),
(261105),
(261171),
(26145),
(26145318),
(261461504),
(261467539),
(26147908),
(261596),
(26161),
(261738),
(26175),
(261825),
(261915062),
(261974),
(262033),
(26207),
(262247),
(26238),
(26239),
(26252),
(26259736),
(262639),
(26268),
(26273),
(26274),
(262788142),
(262857074),
(262913),
(262937),
(262961),
(263093),
(26322),
(26323),
(263232),
(26325966),
(263295),
(263339),
(263424),
(26351024),
(263515824),
(263568),
(263587669),
(263609),
(263765),
(263774786),
(26394),
(264048),
(264239134),
(26433812),
(26453),
(26470411),
(264707946),
(264815),
(26486),
(264897),
(26524),
(265253),
(265539),
(26556501),
(265621),
(26565),
(266017),
(266099),
(266112),
(266238),
(266311),
(26633),
(26642),
(266430),
(266510),
(266598),
(266664),
(26674),
(266745628),
(266767),
(26677),
(266907),
(266974),
(267105),
(267161),
(267304112),
(267344),
(2673708),
(267468),
(267555),
(2675671),
(26765),
(267761),
(26782),
(267850),
(267906),
(268053),
(268141),
(268363),
(26837),
(268503),
(26879202),
(26879258),
(268799),
(26893),
(26906),
(26911),
(269231),
(269271),
(269306),
(26934),
(269599),
(269660),
(269706),
(269764),
(26977),
(26991845),
(269924),
(270315),
(270395),
(270427),
(27049995),
(270586),
(270700),
(270820),
(27098),
(271077),
(27111)
insert into @companyList values
(27129),
(271305),
(271329),
(27133),
(271353957),
(27168),
(27189),
(27191),
(27198),
(27199),
(272054403),
(27222327),
(27223),
(27236),
(27244),
(27271),
(27292837),
(272957),
(27306532),
(27307),
(273212),
(273276),
(273513334),
(27351387),
(273607),
(273981),
(273983758),
(274031831),
(274166),
(274265),
(274350),
(27440804),
(274419),
(27444752),
(27447874),
(274561),
(27460),
(27465),
(274715),
(274818),
(27490),
(27504),
(27508),
(275119),
(275201),
(275232),
(27526391),
(275400),
(275442),
(275547611),
(275573),
(275668),
(275789),
(27582),
(276006),
(276060),
(276190901),
(276209),
(27629813),
(27645),
(27655),
(276599),
(27672),
(27681),
(27685),
(27707),
(277444),
(27745),
(277517),
(27755),
(277563183),
(277575),
(277603),
(277617),
(27763231),
(277709),
(277746),
(277824630),
(277854),
(277894),
(277914),
(277966),
(277994),
(278111),
(27812059),
(278143),
(278212),
(278271),
(278341),
(278369),
(2783831),
(27842),
(27844),
(278446),
(278513),
(278553),
(278556),
(278576),
(27860587),
(27862),
(278679),
(278733),
(278765),
(27877),
(279042),
(27910),
(279167),
(279306),
(279402278),
(279513),
(279534),
(27963),
(27970),
(27973340),
(279750),
(279954),
(280123),
(28014),
(280211),
(280274078),
(28028),
(280322),
(280420),
(28045),
(280561),
(28061),
(28062),
(28071),
(28071116),
(280856),
(280910),
(280944),
(281121),
(281314),
(281407),
(281438),
(28151),
(281820),
(281893),
(281931),
(282005),
(28202),
(28209),
(282225),
(282415),
(282503),
(282539),
(282576),
(28258),
(282590),
(28274),
(282848),
(28291),
(282981),
(283024),
(283234),
(283356),
(28338),
(283410),
(283484),
(283757),
(28381),
(283857),
(28395),
(284137),
(284342),
(28434822),
(28448),
(284564),
(284668),
(284766),
(28479),
(284847),
(285038),
(285125),
(285250),
(28532),
(285325),
(285467),
(2855282),
(285544),
(28556),
(28561473),
(28565),
(285663),
(285827),
(285880),
(285930),
(28606),
(28610038),
(286119),
(286163),
(286180590),
(286187),
(2862715),
(286358),
(286411),
(28646680),
(28671),
(286798),
(286976),
(287043),
(28723),
(28754),
(28756),
(28764),
(287798),
(287950),
(287993),
(288033),
(288195),
(288255),
(288355),
(288502),
(28872678),
(28877),
(288924),
(289030),
(289194),
(289484),
(289620),
(289834),
(29002),
(290060),
(290177),
(290203),
(29031),
(29053039),
(290650),
(290681),
(290733),
(290757),
(2908516),
(290898),
(29096),
(291225),
(291250),
(291286),
(291333),
(29142),
(291518),
(291586),
(291619),
(291703),
(291795),
(2918450),
(291981),
(29204),
(292092),
(292135),
(292268),
(29232),
(29243),
(29252427),
(292525),
(29256),
(29272),
(292742),
(29279),
(29282),
(292826),
(292980),
(293286),
(29344),
(29346),
(293515),
(293569),
(29364),
(293645),
(293680),
(293711),
(29374),
(293889),
(293966),
(294006),
(294167),
(294269),
(294338),
(294382),
(294483),
(294550),
(2945619),
(294639),
(29470),
(294721),
(294799),
(294945),
(294957),
(294994),
(295080),
(29515572),
(295170),
(295224),
(29538),
(295565),
(295624),
(295660),
(29574),
(295915),
(295969),
(296104),
(296129),
(29617),
(29618),
(296181),
(296308),
(296511),
(296527),
(296568),
(296799),
(29685),
(296889),
(296917),
(296957),
(297018),
(297179),
(297210),
(29726),
(29728),
(29729),
(297294),
(297384),
(297463012),
(297526),
(29753),
(297545),
(297620),
(29762552),
(297660),
(297799),
(29780),
(297850),
(29794),
(298014),
(29814932),
(298176),
(2982993),
(2983116),
(2983403),
(298400),
(298441),
(298482),
(298571),
(298753),
(298950),
(298968),
(29902),
(299095),
(299263),
(29929),
(299515),
(29962),
(29963),
(29969),
(299702),
(30000),
(30009227),
(30012),
(300504),
(30061),
(300644),
(300794),
(300942),
(301040),
(301069),
(30116),
(30116605),
(30120841),
(30133),
(301580992),
(301667),
(301669938),
(3017691),
(30177530),
(301891),
(301966),
(30202),
(30205),
(302143),
(30223),
(30232680),
(30244916),
(302480),
(30253),
(302594),
(302617),
(302707),
(3027333),
(3027743),
(302907),
(30292),
(30300),
(303104),
(30323),
(303303),
(30336380),
(303397),
(30345),
(303526),
(303591),
(303646),
(303689323),
(30379),
(303828),
(303885),
(303923),
(30396158),
(304124),
(304195),
(30421),
(30422),
(304227),
(304260),
(304284),
(304285),
(304383),
(30439),
(30451),
(30472),
(30485592),
(304977),
(30506),
(305082),
(30511),
(30513),
(305213),
(305467),
(30547),
(30550),
(305583),
(30573),
(305749),
(30575),
(30591),
(306013),
(306072),
(30613),
(306225),
(30643),
(306496),
(30655),
(306596),
(306688),
(306822),
(306963),
(307180),
(307265),
(30727),
(307375),
(307430),
(307501),
(30760),
(30763),
(30771),
(307782),
(307816),
(30785),
(307930),
(30795),
(30796),
(307982),
(308047),
(30820),
(308226),
(30822601),
(30823371),
(30834687),
(30839),
(308402),
(30843),
(308492871),
(308582),
(308587101),
(30860),
(308678),
(308806),
(308973),
(309122562),
(309162),
(309250887),
(309400),
(309456),
(309606),
(309681),
(309779),
(3097815),
(309845),
(30992759),
(309966),
(310076),
(310078),
(310240),
(310310),
(3103259),
(3103615),
(31046),
(31063165),
(310667),
(310736),
(310857479),
(3109188),
(310955),
(311239),
(311453),
(31148),
(31152),
(31153),
(311679),
(311760),
(3117990),
(311820),
(31186),
(31197),
(31217),
(312427),
(312648),
(31267),
(312769),
(312795578),
(31283),
(3128326),
(3128334),
(312949),
(313031),
(313055),
(313134),
(313220),
(31324),
(3132512),
(3133890),
(313393),
(313461),
(31348),
(313506),
(313509),
(31365),
(313734),
(313784),
(31380),
(31390),
(313947),
(314057),
(314312),
(314515),
(31463),
(314690),
(314750),
(31476),
(314842),
(314896),
(314960),
(31498),
(314995),
(31500),
(315117),
(315149),
(315210),
(315260),
(315394),
(3154614),
(315638543),
(315756),
(31577),
(31585),
(315884),
(3159732),
(316001),
(3160269),
(3163101),
(316367),
(31637),
(31670),
(316760073),
(316829),
(316877),
(3169998),
(317037),
(317227),
(31726),
(3173937),
(317519),
(317557),
(317627),
(317668),
(31772),
(317975),
(318049),
(318091),
(3181355),
(3182334),
(318505463),
(31864),
(318820),
(3188545),
(3188722),
(31900),
(319092),
(319157),
(319205),
(31926),
(319334),
(319384),
(319450),
(319532),
(319534),
(31973),
(3197334),
(3197361),
(3198565),
(3198633),
(3198786),
(3198815),
(320039344),
(320082),
(320105),
(32012),
(320141334),
(320186),
(320269),
(320303),
(320333),
(320371),
(32052),
(320570),
(32068),
(32073),
(320908),
(321180),
(321244),
(32137),
(321590),
(321778),
(32181),
(32184),
(322091),
(322121),
(32215),
(3222595),
(322298),
(322481),
(32265),
(322735),
(322777),
(322867),
(32290),
(32305),
(32307),
(323175),
(32352),
(323532),
(32356),
(323746),
(323756013),
(323857),
(32389646),
(32401),
(32410),
(324289),
(324452),
(32464),
(32471),
(32530),
(325333),
(32538),
(325428),
(32561),
(325619),
(325643),
(325771),
(32583),
(32588621),
(32590567),
(32596),
(32605),
(32638),
(326382),
(32657),
(326614),
(326838),
(327025),
(32710),
(32717),
(327291),
(327353),
(327408),
(327436),
(327460),
(3274917),
(32768),
(327735),
(327880),
(328190),
(32830),
(328377),
(32854),
(32855017),
(328571),
(328799),
(328874),
(32893341),
(3289679),
(32901),
(329083),
(329141),
(32919),
(329202),
(329287),
(32978),
(329891),
(329935),
(330043),
(330123),
(330170),
(330325),
(330453),
(330589),
(330661),
(33067),
(330672765),
(33080),
(331205),
(33127),
(331298),
(33130),
(331334),
(331476),
(331701),
(33174798),
(33180),
(33184),
(331949),
(332172),
(332250),
(332273),
(332311),
(332358),
(332476),
(332500),
(33254),
(332646),
(332700),
(332730),
(332954),
(33303923),
(333191),
(333273375),
(33328),
(333294),
(333332),
(333701),
(333765),
(333835),
(33384931),
(33386),
(333920),
(33398),
(33402796),
(33405327),
(334158),
(33420),
(334221),
(33424519),
(334367),
(33447962),
(334622),
(33493),
(335019),
(33509),
(33509757),
(33510148),
(33530),
(335306),
(33543),
(33560),
(33574),
(335798),
(335919),
(33593027),
(335973),
(336027),
(33604),
(336160),
(336277),
(33636),
(336458),
(336520),
(33679),
(33710),
(33715),
(337183),
(33764),
(33765),
(33769),
(337694),
(337708),
(33797),
(338018),
(33813),
(338134),
(33821),
(338214),
(338287),
(33832624),
(338403),
(338454),
(338513),
(338612),
(338729),
(33880),
(338943),
(33897),
(33926),
(339305),
(33931),
(339407),
(339447),
(339482),
(33950),
(33956),
(33982),
(339972),
(34001),
(340230),
(340272),
(34032),
(34039),
(340391),
(34048601),
(3405946),
(34067),
(34071),
(34071196),
(340736),
(34074951),
(34095687),
(341326),
(34138),
(341395),
(341530),
(341584),
(34177),
(341990),
(34219),
(34225),
(342453),
(34265589),
(34284),
(34306),
(343086),
(34335),
(34345),
(34378),
(343802),
(344112),
(344249),
(344284),
(344489),
(344562930),
(34490826),
(3449701),
(3451109),
(345779),
(34590),
(346012),
(346068),
(34611),
(346200),
(346270),
(346334),
(34640),
(346489),
(34682),
(34698),
(347035),
(34705),
(34709),
(347306),
(3473779),
(34740),
(34745),
(347535),
(347586),
(34765897),
(34768),
(3478354),
(347983),
(3479948),
(348016),
(34817),
(348238),
(348748),
(34874958),
(348788),
(34883),
(348835),
(348893),
(34917),
(34952431),
(34970103),
(349721)
insert into @companyList values
(34990),
(34999),
(35000),
(35001),
(35003),
(35013),
(350153),
(350185),
(350318),
(350381),
(350405),
(350475),
(350503),
(350975),
(351162),
(352094),
(352350),
(35245481),
(35246128),
(35259),
(352620),
(352674),
(352769),
(352851),
(35298),
(353020),
(35303),
(353073),
(35312),
(353216),
(353253),
(35343499),
(353508),
(353867),
(35418),
(35426),
(35436),
(354361),
(35443),
(3545047),
(3547368),
(35475),
(35511785),
(355279),
(355432),
(355505),
(35576),
(355859),
(35600),
(35604),
(356133),
(35623987),
(356264),
(35631),
(3563798),
(35644),
(35647020),
(35648556),
(35650),
(35652),
(356618),
(356725),
(35695),
(356983),
(3572148),
(357301),
(35773),
(35806),
(35839),
(358694),
(3587084),
(35901),
(359017),
(3590733),
(35921712),
(35922),
(359339),
(35962803),
(359638),
(3596787),
(36005),
(36012134),
(360124),
(36013),
(36018),
(36033),
(36040),
(360416),
(3606161),
(36070),
(360791),
(36098),
(361068),
(361133),
(36122),
(361335),
(36146),
(361523),
(361617),
(361972),
(362000),
(36213),
(36214016),
(36216),
(36218),
(362220),
(36235),
(36265),
(362798),
(363003),
(363049),
(36318),
(363263),
(3632895),
(363597),
(363811),
(36398),
(364040),
(36437),
(36451),
(364700),
(364744),
(36476295),
(36478),
(3648194),
(36492),
(365013),
(36507),
(36508),
(365092),
(365114),
(365138),
(36536),
(365436),
(36551281),
(365997),
(36602),
(36610),
(3661558),
(36616),
(366230),
(36627),
(366314),
(36633475),
(36652),
(367118),
(36731),
(36762),
(367749),
(36776),
(36787),
(368278),
(368470),
(368607),
(36873737),
(368787),
(369346816),
(370017),
(370122),
(370413),
(370714),
(370857),
(371065),
(3711992),
(371281),
(371481),
(371856),
(372526),
(3732086),
(373264),
(3735944),
(373691),
(373702),
(374377),
(375780),
(37644463),
(376695),
(376921),
(376941),
(37709),
(377361),
(377732),
(3778171),
(377837),
(378088),
(378225),
(378537),
(378719),
(378755),
(378915),
(379037),
(379153),
(379493),
(379819),
(37995045),
(380011),
(38043467),
(38043973),
(380521),
(381068),
(381324),
(381591),
(381848),
(381997),
(382071),
(382127),
(382553),
(382724),
(383410),
(383754),
(384253),
(384381),
(384522),
(384639),
(384687),
(38572588),
(385872),
(385920),
(38610394),
(386225),
(386287),
(386289),
(386673),
(387097),
(387127),
(387513),
(387568),
(388397),
(388763),
(388819),
(38893720),
(389218),
(38933807),
(389726),
(390157),
(390225),
(391396),
(39153321),
(392731),
(392966),
(39348049),
(393488),
(393940),
(394038),
(394083),
(39413743),
(394466),
(394524),
(395442),
(39558105),
(395750),
(396177),
(396263),
(396353),
(397052),
(397072),
(397138),
(397414),
(397508),
(398144),
(398351),
(398549),
(398674),
(398784),
(399023),
(399117),
(399147),
(399217),
(399407),
(399462),
(399584),
(399700),
(399960),
(400224),
(400280),
(40084670),
(4008586),
(401541),
(401890),
(4026446),
(4027729),
(402971),
(402993),
(403719),
(404061),
(404105),
(404476),
(404682),
(40489588),
(405201),
(405257),
(405277),
(405465),
(405779),
(405869),
(406338),
(406606),
(406706),
(406896),
(407024),
(4080778),
(409424),
(410364),
(4107517),
(411220),
(411254),
(411342),
(411576),
(411950),
(411996),
(4120015),
(412052),
(412450),
(412632),
(413188),
(413190),
(413544),
(413831),
(413857),
(415352),
(4155690),
(415798),
(4161770),
(4163332),
(416404),
(4165287),
(41694753),
(417206),
(4180463),
(4182538),
(4184604),
(419781),
(4204488),
(4212820),
(4222231),
(422760),
(4233177),
(4235187),
(424556),
(424735),
(424885),
(4249970),
(4273768),
(42741660),
(42757816),
(4277008),
(4277141),
(4277236),
(4279240),
(4282491),
(4291896),
(4303924),
(4306112),
(4347554),
(43528096),
(435998),
(4368282),
(4368532),
(4370094),
(43960896),
(4420411),
(4422197),
(44459271),
(44709159),
(4481293),
(4485863),
(4492976),
(4497349),
(4497433),
(4508880),
(4528419),
(4544094),
(4567986),
(45987976),
(4613444),
(4640784),
(47054664),
(4730973),
(47371679),
(4741083),
(47411570),
(47531149),
(4773926),
(4800830),
(4803544),
(4860367),
(4876557),
(48809313),
(48853897),
(4890306),
(48933961),
(48993116),
(49276069),
(4932759),
(4940151),
(4993771),
(4997563),
(50206680),
(502751),
(5027624),
(5092377),
(51185930),
(515275),
(515923),
(517300),
(51738175),
(518638),
(518807),
(519411),
(520217),
(523176),
(526475),
(526573),
(526813),
(526921),
(526950),
(527252),
(527317),
(527364),
(527542),
(527596),
(527692),
(528325),
(528410),
(528414),
(528420),
(528955),
(53262489),
(5381745),
(5395961),
(5419323),
(5422066),
(5480744),
(5491205),
(553033),
(556909),
(5600655),
(588096),
(59036089),
(59049563),
(59151858),
(59220391),
(59503383),
(596117),
(598651),
(598666),
(598671),
(598689),
(598766),
(598808),
(6020983),
(6036497),
(603843),
(607483),
(61036),
(61177529),
(61199),
(61206100),
(61243),
(61292),
(6158729),
(61690445),
(617309),
(617490),
(61761808),
(6184168),
(6184525),
(618558),
(6186258),
(618908),
(61967803),
(619981),
(621806),
(621918),
(6227448),
(62541018),
(62670872),
(631759),
(6330458),
(642957),
(643621),
(6439171),
(645715),
(645776),
(6463398),
(6464151),
(6469353),
(6476441),
(6477196),
(6491293),
(655308),
(655542),
(655659),
(6565801),
(6569181),
(658507),
(658616),
(658767),
(6628356),
(66289856),
(6631173),
(664429),
(666631),
(6670721),
(675577),
(6757990),
(677376),
(677601),
(679139),
(679630),
(681029),
(682252),
(683720),
(6868151),
(687117),
(687140),
(687261),
(6886820),
(688713),
(6890373),
(689588),
(6904040),
(6908954),
(69189070),
(694640),
(695089),
(695204),
(695247),
(696281),
(696647),
(697701),
(7009878),
(701143),
(701179),
(704634),
(705287),
(705790),
(7131811),
(71456863),
(714668),
(715240),
(7195658),
(72526252),
(728889),
(731313),
(731580),
(734078),
(734865),
(738400),
(739115),
(739693),
(739698),
(742365),
(744526),
(745257),
(7471769),
(7489861),
(752915),
(754046),
(754881),
(7620997),
(7642030),
(7654173),
(7657914),
(765841),
(7662427),
(7665877),
(7666044),
(7668333),
(7670016),
(7675730),
(7683151),
(7685238),
(7704259),
(7731428),
(779331),
(7797659),
(780053),
(7818664),
(78749412),
(7910540),
(79161058),
(7918123),
(792424),
(79277661),
(794857),
(795040),
(7958431),
(7959935),
(8032784),
(805302),
(805585),
(8057672),
(8059421),
(8063879),
(8100663),
(810569),
(8122428),
(813573),
(813574),
(816889),
(819163),
(821389),
(82392972),
(8251223),
(8275373),
(8285048),
(831552),
(832494),
(838923),
(83920810),
(841205),
(841685),
(844756),
(854654),
(8591867),
(8610803),
(862598),
(862673),
(864032),
(873636),
(873641),
(873644),
(873648),
(873664),
(873695),
(873739),
(873742),
(873777),
(873792),
(873801),
(873804),
(873811),
(873813),
(873829),
(873832),
(873865),
(873874),
(873878),
(873897),
(873908),
(873917),
(873959),
(8740684),
(874078),
(874091),
(874125),
(874183),
(874190),
(874204),
(874249),
(874387),
(874480),
(874520),
(874645),
(874793),
(874827),
(874940),
(874988),
(875094),
(875120),
(875260),
(875334),
(875371),
(875453),
(875502),
(875568),
(875575),
(875612),
(875715),
(875838),
(875860),
(876006),
(876060),
(876067),
(876162),
(876199),
(876290),
(876323),
(876449),
(876577),
(876653),
(876661),
(876815),
(876861),
(877188),
(877270),
(877301),
(877535),
(877972),
(877990),
(878056),
(878093),
(878219),
(878373),
(878612),
(878615),
(879180),
(8793945),
(879555),
(879581),
(879730),
(879806),
(880059),
(880071),
(880193),
(880235),
(880251),
(880253),
(880287),
(880295),
(880311),
(880318),
(880393),
(880420),
(880494),
(880530),
(881094),
(881137),
(881155),
(881184),
(881203),
(881219),
(881300),
(881317),
(881367),
(881381),
(881409),
(881426),
(881430),
(881518),
(881624),
(882007),
(882041),
(882217),
(882318),
(882380),
(882569),
(882696),
(882767),
(882769),
(882794),
(882855),
(882937),
(882943),
(882950),
(883129),
(883197),
(8840403),
(884393),
(884401),
(887314),
(890498),
(89450),
(89538),
(896851),
(89809),
(9003256),
(9026347),
(90393),
(9051877),
(909408),
(91031),
(91092),
(91093),
(91192),
(915425),
(91675),
(91774),
(91797),
(9179990),
(91800),
(91823),
(91825),
(91868),
(92274),
(9247431),
(92578),
(92629),
(92639),
(92699),
(92716),
(92757),
(92768),
(9277653),
(92817),
(9282918),
(92852),
(92866),
(93024),
(93025),
(93026),
(93027),
(93028),
(93030),
(9306827),
(93196),
(93323),
(93339),
(93396),
(93425),
(93488),
(93547),
(93614),
(93624),
(93625),
(9363618),
(93904),
(94104),
(94188),
(94192),
(94197),
(94238),
(94243),
(94412),
(9444413),
(94613),
(94614),
(94728),
(94734),
(94799),
(94877),
(95153),
(95164),
(9525280),
(9532739),
(955392),
(955448),
(956269),
(95673),
(9573447),
(958929),
(9589732),
(95993),
(960673),
(96078),
(96079),
(96086),
(96161),
(9617257),
(9620336),
(96760),
(9681063),
(97023),
(97199),
(972115),
(972117),
(97423),
(9748502),
(97487),
(976038),
(97706),
(97928),
(97957),
(97965),
(981598),
(98186),
(98232368),
(983017),
(983307),
(98506),
(98509),
(98514),
(985438),
(98803),
(9885878),
(9885902),
(98873),
(98885),
(98924),
(9913586),
(9917384),
(99186),
(9956099),
(9962209),
(99856262),
(998579)
declare @companyTable table (companyId int, gvkey varchar(6), iid varchar(3))
declare @dataItemId int
set @dataItemId = '4193' --1007 total assets
declare @evalDate datetime2
set @evalDate = dateadd(day,-1, cast(getdate() as date))

/* Temp vars */
insert into @companyTable
select co.companyId, gvkey, iid
FROM [CompustatData].[dbo].[ciqCompany] co
left join [CompustatData].[dbo].[ciqSecurity] se on se.[companyId] = co.[companyId]
left join [CompustatData].[dbo].[ciqTradingItem] ti on ti.securityId = se.securityId
left join [CompustatData].[dbo].[ciqGvkeyIID] gv on ti.[tradingItemId] = gv.[objectId]
left join [CompustatData].[dbo].[ciqSecuritySubType] st on st.[securitySubTypeId] = se.[securitySubTypeId]
where co.[companyId] in (select companyId from @companyList)
and st.[securitySubTypeId] = 1 --common stock
and se.[primaryFlag] = 1 --primary stock issue
and gv.gvkey is not null and gv.iid is not null
--select * from @companyTable
--order by gvkey

/* Adjusted prices */
SELECT dp.[gvkey],dp.[iid],dp.[datadate],((isnull(dt.[trfd],1)) * dp.[prccd]) /  isnull(ad.[splitvalue],1) AS PRCCD_ADJ ,((isnull(dt.[trfd],1)) * dp.[cshtrd]) /  isnull(ad.[splitvalue],1) AS CSHTRD_ADJ
FROM [CompustatData].[dbo].[sec_dprc] dp
outer apply
(select top 1 [trfd] --, max([trfd]) as trfd_max
FROM [CompustatData].[dbo].[sec_dtrt]
where [gvkey] = dp.gvkey and [iid] = dp.[iid] and [datadate] <= dp.[datadate]
order by [datadate] desc
)  dt
outer apply
(select top 1 [splitvalue]
from [CompustatData].[dbo].[sec_adjfact]
where [gvkey] = dp.gvkey and [iid] = dp.[iid] and [effdate] <= dp.[datadate]
order by [effdate] desc
)  ad
left join 
(select [gvkey], [iid], max(trfd) as trfd_max
from [CompustatData].[dbo].[sec_dtrt]
--where [gvkey] = dp.gvkey and [iid] = dp.[iid]
group by [gvkey],[iid]
) tx
on tx.[gvkey] = dp.gvkey and tx.[iid] = dp.[iid]
where dp.gvkey + dp.iid in (select gvkey + iid from @companyTable)
and dp.[datadate] between '12/20/2004' and @evalDate
order by dp.gvkey + dp.iid, datadate
"""

adjprices = pandas.io.sql.read_sql(sql, ciqdb)
#%%                     
sql = """
set NOCOUNT ON

declare @dataItemId int
set @dataItemId = '4193' --1007 total assets
declare @evalDate datetime2
set @evalDate = dateadd(day,-1, cast(getdate() as date))

SELECT [companyId],[pricingDate],[marketCap],[TEV],[sharesOutstanding]
FROM [CompustatData].[dbo].[ciqMarketCap]
where companyId  in ((10004874),
(100058833),
(1002291),
(100231),
(1002357),
(10028455),
(10040674),
(1004106),
(100410633),
(100440),
(100489288),
(100537),
(1006484),
(100787816),
(10081196),
(100918),
(100934),
(100937),
(1011775),
(101992492),
(10214722),
(102169),
(102267652),
(102348),
(1027055),
(1032802),
(103284),
(103375),
(103518),
(103599),
(103678),
(1038312),
(1038325),
(1038327),
(1038355),
(1038362),
(1039587),
(10404838),
(1040657),
(104643),
(104673),
(10494135),
(1050056),
(1051325),
(105291345),
(105612),
(1057473),
(105768270),
(105841183),
(1059251),
(106335),
(1064020),
(106426),
(106437),
(106485352),
(106530929),
(106577),
(106636),
(1066957),
(106772),
(1067744),
(106987),
(10739227),
(107405),
(107633),
(10779727),
(107911),
(108253),
(108522),
(108544),
(108616),
(108839),
(108856),
(109103),
(109131),
(109136),
(109300),
(10969688),
(110001),
(110044279),
(110741),
(11113129),
(111314384),
(111358),
(11147204),
(111790273),
(11207402),
(112165),
(112302),
(112305),
(112350),
(113073),
(113131),
(113541117),
(11365458),
(113665065),
(11382658),
(113922672),
(113970207),
(114039),
(114063305),
(1141723),
(11420997),
(11478068),
(114823784),
(115032605),
(115102487),
(11515826),
(115779020),
(117842106),
(117912488),
(118218449),
(118315802),
(11857151),
(118605496),
(11888172),
(11902093),
(119033497),
(119902),
(120262),
(120285),
(120367),
(120406),
(120622),
(120623),
(120909),
(121238),
(121246),
(121483),
(121509),
(121534),
(121729),
(121767),
(122212),
(122699),
(122917),
(12296252),
(12297011),
(123217),
(12344550),
(123891),
(1239256),
(1241057),
(124219),
(124243),
(124307),
(124321),
(124423),
(124565),
(124878),
(12518001),
(125228),
(12534920),
(125757),
(1261061),
(126269),
(12633071),
(126362),
(126411),
(12666489),
(126668),
(126921),
(127095032),
(12719228),
(12722790),
(127583),
(127694719),
(127719),
(127881),
(127918),
(128209),
(12826523),
(128540),
(128584),
(128845270),
(129318),
(129396129),
(129679427),
(130258307),
(13061287),
(130689),
(130705),
(130863),
(13103664),
(131112810),
(131731858),
(13190293),
(132077212),
(133282),
(13356885),
(1340740),
(1340741),
(134106179),
(1341470),
(1341753),
(1342556),
(1342560),
(1343561),
(134603330),
(1348220),
(134992),
(13529856),
(13529992),
(135311),
(135443),
(135470),
(135474),
(13627017),
(136333),
(136356),
(13639172),
(136442),
(13649709),
(137240118),
(137304893),
(137411),
(137473239),
(13756315),
(13757558),
(137649125),
(138296738),
(138613332),
(139317925),
(139431),
(139488),
(139673),
(139677),
(139813),
(139997035),
(140233),
(140283),
(140950927),
(141108755),
(1413204),
(1413208),
(141581761),
(141827503),
(141885706),
(141930906),
(142250097),
(1425530),
(142670771),
(142879),
(142892259),
(144258),
(144405183),
(145116275),
(145625476),
(145737384),
(1458681),
(1462309),
(1494343),
(1495607),
(1519864),
(1528824),
(1533412),
(1534795),
(154054449),
(1541811),
(1543272),
(1543637),
(154924),
(155172),
(1565109),
(1566745),
(157028),
(1570880),
(1587862),
(159230),
(160077),
(160180),
(160197),
(160233),
(1611542),
(162270),
(163087),
(163111),
(164034),
(165298),
(166314),
(166457),
(1666001),
(166802),
(167945),
(168151),
(168154),
(168182),
(1683286),
(168569),
(168864),
(169142),
(169308),
(169838),
(1699197),
(170198295),
(170245760),
(170260),
(170352),
(170571),
(170928919),
(171106),
(171116),
(171445),
(171604),
(171649),
(171737),
(1717518),
(172055),
(172131),
(172207),
(172472),
(172899),
(173094),
(173341),
(173840),
(173927),
(174336),
(174438),
(174901),
(175110),
(175265),
(175480),
(1756150),
(175749),
(176102),
(176159),
(176787),
(177031),
(177126),
(177251),
(177500),
(177698),
(177934),
(178254),
(178296),
(178946),
(178976),
(1789909),
(1790684),
(179862),
(180871),
(181003),
(181176),
(181478),
(181943700),
(182505),
(182707),
(182949),
(183089),
(183811756),
(184128240),
(184157327),
(1843135),
(184841),
(184945),
(18527),
(185333),
(185508),
(185801),
(18671),
(186785),
(18749),
(1876050),
(188244),
(188335),
(188477),
(188653),
(189096),
(189282),
(189424),
(189426),
(189526),
(189539),
(189848),
(19007),
(190137),
(190268),
(190358),
(190489),
(190636),
(190694),
(190756),
(190786),
(190876),
(19095),
(190965),
(191013),
(191216),
(191328),
(191564),
(191884),
(192089),
(19209),
(192186),
(1921896),
(1925656),
(1944751),
(195901),
(19609),
(19691),
(1974492),
(197773),
(19839),
(199022),
(200128),
(200199),
(20119),
(203002),
(203101),
(204710830),
(20496676),
(20522974),
(20523038),
(205233),
(20531152),
(20571),
(20721550),
(207221),
(20801430),
(20963),
(2102034),
(210392),
(21127),
(21171),
(2125636),
(212766522),
(213048879),
(213879),
(214103601),
(2141734),
(215339359),
(215342183),
(215548781),
(21609),
(216313883),
(216581935),
(2168124),
(217389033),
(217503),
(21835),
(21842239),
(218812),
(21919911),
(219437),
(21954621),
(220168),
(22039608),
(22077696),
(22183895),
(22236226),
(22238416),
(222402013),
(222406786),
(22247),
(222554189),
(22261533),
(22298592),
(22357184),
(2238172),
(22385966),
(224003614),
(22413056),
(224325923),
(224946128),
(225078297),
(22511),
(22548461),
(225523981),
(22603885),
(22614982),
(226200263),
(226530250),
(226584812),
(22666093),
(226898),
(22691841),
(22747149),
(22751),
(22768589),
(22771433),
(22800180),
(22805),
(228070761),
(22848913),
(228755),
(22883846),
(22920207),
(22929077),
(22967487),
(23013),
(230297),
(23046303),
(23081173),
(2312985),
(231688165),
(231691952),
(232036063),
(232335127),
(23270929),
(23287),
(233427056),
(233582617),
(23374622),
(23499518),
(23500974),
(23553263),
(23557),
(23626080),
(23644436),
(23682136),
(23702309),
(237656125),
(23812789),
(23815047),
(2381717),
(23838378),
(238570),
(23873120),
(23939254),
(24003473),
(24043),
(240460878),
(2405489),
(240792646),
(24080914),
(240823191),
(24085),
(240936085),
(24114004),
(2413126),
(241463154),
(241494537),
(24154988),
(24165),
(241709041),
(241738548),
(241782379),
(24202),
(242099548),
(24225),
(24246),
(24249112),
(242798179),
(24281),
(24292),
(24321),
(24333),
(2433584),
(24362),
(243649654),
(24368),
(243685275),
(243685856),
(243907022),
(244370933),
(24442),
(24443077),
(244741443),
(24494),
(24504),
(24505),
(24522),
(245507),
(245786818),
(24603),
(24604),
(246100779),
(24620),
(246279126),
(246545),
(24658),
(246886),
(24689),
(247017859),
(247026262),
(24704),
(247170),
(247198),
(247261058),
(24732),
(247347),
(247371),
(24738407),
(247483),
(24753),
(247574887),
(24758),
(247593650),
(24766),
(24771),
(247782),
(24779),
(247842371),
(24801),
(24804),
(24809),
(2481334),
(24816),
(24821),
(248256),
(24827),
(248270),
(248356),
(2483732),
(24842),
(248450),
(24846),
(248501),
(248608),
(248655),
(24879),
(248823),
(248858755),
(24886525),
(248869),
(2488839),
(248916),
(24893),
(249061912),
(249110868),
(249126),
(249205),
(249319773),
(24937),
(249436),
(24950477),
(249603),
(24967),
(249726),
(24980220),
(249841),
(24985251),
(249925),
(24994),
(249999),
(250037),
(250079),
(25026),
(250312),
(250388),
(25039993),
(25046),
(250532),
(250592),
(25063),
(25080),
(250859),
(2508590),
(250885),
(25090458),
(25109),
(251230),
(251258),
(25134),
(251349),
(251411),
(251475),
(251704),
(251719973),
(251849),
(25191),
(252088241),
(252150),
(2522534),
(252257),
(252339),
(2523864),
(252431),
(252517),
(252551),
(252684),
(252743080),
(2527714),
(252978),
(253018),
(25304),
(25307),
(253076),
(253132),
(253239200),
(25334),
(253388),
(2534215),
(253561),
(2535666),
(253702),
(253706543),
(253730),
(25403751),
(254131),
(254193),
(254287707),
(25447),
(254497048),
(254571),
(25460099),
(254725),
(25478219),
(254847),
(25489),
(254965),
(255055),
(255132),
(255251),
(255397),
(255524),
(255627),
(2557009),
(25572071),
(255743),
(2557643),
(255781),
(255902),
(25605),
(256200),
(25643),
(256487722),
(256523),
(256558670),
(256689),
(25673),
(256839),
(256893),
(25708),
(257151),
(257198),
(257424),
(257568),
(257682),
(25776),
(25777),
(257948),
(25798),
(25812479),
(258133),
(25820),
(25823),
(258278),
(25836053),
(25839),
(258458),
(258532),
(258589),
(25864),
(258769),
(258791),
(258823),
(258891),
(258937),
(25910408),
(25915843),
(259212),
(25922),
(259280),
(25933),
(25935),
(259378),
(25941),
(259589),
(259731),
(25981),
(259829),
(259957),
(260119),
(26014489),
(260149),
(260291),
(260414),
(260583),
(260619),
(26069),
(260725),
(26079217),
(260824267),
(260858),
(260920),
(261084576),
(261105),
(261171),
(26145),
(26145318),
(261461504),
(261467539),
(26147908),
(261596),
(26161),
(261738),
(26175),
(261825),
(261915062),
(261974),
(262033),
(26207),
(262247),
(26238),
(26239),
(26252),
(26259736),
(262639),
(26268),
(26273),
(26274),
(262788142),
(262857074),
(262913),
(262937),
(262961),
(263093),
(26322),
(26323),
(263232),
(26325966),
(263295),
(263339),
(263424),
(26351024),
(263515824),
(263568),
(263587669),
(263609),
(263765),
(263774786),
(26394),
(264048),
(264239134),
(26433812),
(26453),
(26470411),
(264707946),
(264815),
(26486),
(264897),
(26524),
(265253),
(265539),
(26556501),
(265621),
(26565),
(266017),
(266099),
(266112),
(266238),
(266311),
(26633),
(26642),
(266430),
(266510),
(266598),
(266664),
(26674),
(266745628),
(266767),
(26677),
(266907),
(266974),
(267105),
(267161),
(267304112),
(267344),
(2673708),
(267468),
(267555),
(2675671),
(26765),
(267761),
(26782),
(267850),
(267906),
(268053),
(268141),
(268363),
(26837),
(268503),
(26879202),
(26879258),
(268799),
(26893),
(26906),
(26911),
(269231),
(269271),
(269306),
(26934),
(269599),
(269660),
(269706),
(269764),
(26977),
(26991845),
(269924),
(270315),
(270395),
(270427),
(27049995),
(270586),
(270700),
(270820),
(27098),
(271077),
(27111),
(27129),
(271305),
(271329),
(27133),
(271353957),
(27168),
(27189),
(27191),
(27198),
(27199),
(272054403),
(27222327),
(27223),
(27236),
(27244),
(27271),
(27292837),
(272957),
(27306532),
(27307),
(273212),
(273276),
(273513334),
(27351387),
(273607),
(273981),
(273983758),
(274031831),
(274166),
(274265),
(274350),
(27440804),
(274419),
(27444752),
(27447874),
(274561),
(27460),
(27465),
(274715),
(274818),
(27490),
(27504),
(27508),
(275119),
(275201),
(275232),
(27526391),
(275400),
(275442),
(275547611),
(275573),
(275668),
(275789),
(27582),
(276006),
(276060),
(276190901),
(276209),
(27629813),
(27645),
(27655),
(276599),
(27672),
(27681),
(27685),
(27707),
(277444),
(27745),
(277517),
(27755),
(277563183),
(277575),
(277603),
(277617),
(27763231),
(277709),
(277746),
(277824630),
(277854),
(277894),
(277914),
(277966),
(277994),
(278111),
(27812059),
(278143),
(278212),
(278271),
(278341),
(278369),
(2783831),
(27842),
(27844),
(278446),
(278513),
(278553),
(278556),
(278576),
(27860587),
(27862),
(278679),
(278733),
(278765),
(27877),
(279042),
(27910),
(279167),
(279306),
(279402278),
(279513),
(279534),
(27963),
(27970),
(27973340),
(279750),
(279954),
(280123),
(28014),
(280211),
(280274078),
(28028),
(280322),
(280420),
(28045),
(280561),
(28061),
(28062),
(28071),
(28071116),
(280856),
(280910),
(280944),
(281121),
(281314),
(281407),
(281438),
(28151),
(281820),
(281893),
(281931),
(282005),
(28202),
(28209),
(282225),
(282415),
(282503),
(282539),
(282576),
(28258),
(282590),
(28274),
(282848),
(28291),
(282981),
(283024),
(283234),
(283356),
(28338),
(283410),
(283484),
(283757),
(28381),
(283857),
(28395),
(284137),
(284342),
(28434822),
(28448),
(284564),
(284668),
(284766),
(28479),
(284847),
(285038),
(285125),
(285250),
(28532),
(285325),
(285467),
(2855282),
(285544),
(28556),
(28561473),
(28565),
(285663),
(285827),
(285880),
(285930),
(28606),
(28610038),
(286119),
(286163),
(286180590),
(286187),
(2862715),
(286358),
(286411),
(28646680),
(28671),
(286798),
(286976),
(287043),
(28723),
(28754),
(28756),
(28764),
(287798),
(287950),
(287993),
(288033),
(288195),
(288255),
(288355),
(288502),
(28872678),
(28877),
(288924),
(289030),
(289194),
(289484),
(289620),
(289834),
(29002),
(290060),
(290177),
(290203),
(29031),
(29053039),
(290650),
(290681),
(290733),
(290757),
(2908516),
(290898),
(29096),
(291225),
(291250),
(291286),
(291333),
(29142),
(291518),
(291586),
(291619),
(291703),
(291795),
(2918450),
(291981),
(29204),
(292092),
(292135),
(292268),
(29232),
(29243),
(29252427),
(292525),
(29256),
(29272),
(292742),
(29279),
(29282),
(292826),
(292980),
(293286),
(29344),
(29346),
(293515),
(293569),
(29364),
(293645),
(293680),
(293711),
(29374),
(293889),
(293966),
(294006),
(294167),
(294269),
(294338),
(294382),
(294483),
(294550),
(2945619),
(294639),
(29470),
(294721),
(294799),
(294945),
(294957),
(294994),
(295080),
(29515572),
(295170),
(295224),
(29538),
(295565),
(295624),
(295660),
(29574),
(295915),
(295969),
(296104),
(296129),
(29617),
(29618),
(296181),
(296308),
(296511),
(296527),
(296568),
(296799),
(29685),
(296889),
(296917),
(296957),
(297018),
(297179),
(297210),
(29726),
(29728),
(29729),
(297294),
(297384),
(297463012),
(297526),
(29753),
(297545),
(297620),
(29762552),
(297660),
(297799),
(29780),
(297850),
(29794),
(298014),
(29814932),
(298176),
(2982993),
(2983116),
(2983403),
(298400),
(298441),
(298482),
(298571),
(298753),
(298950),
(298968),
(29902),
(299095),
(299263),
(29929),
(299515),
(29962),
(29963),
(29969),
(299702),
(30000),
(30009227),
(30012),
(300504),
(30061),
(300644),
(300794),
(300942),
(301040),
(301069),
(30116),
(30116605),
(30120841),
(30133),
(301580992),
(301667),
(301669938),
(3017691),
(30177530),
(301891),
(301966),
(30202),
(30205),
(302143),
(30223),
(30232680),
(30244916),
(302480),
(30253),
(302594),
(302617),
(302707),
(3027333),
(3027743),
(302907),
(30292),
(30300),
(303104),
(30323),
(303303),
(30336380),
(303397),
(30345),
(303526),
(303591),
(303646),
(303689323),
(30379),
(303828),
(303885),
(303923),
(30396158),
(304124),
(304195),
(30421),
(30422),
(304227),
(304260),
(304284),
(304285),
(304383),
(30439),
(30451),
(30472),
(30485592),
(304977),
(30506),
(305082),
(30511),
(30513),
(305213),
(305467),
(30547),
(30550),
(305583),
(30573),
(305749),
(30575),
(30591),
(306013),
(306072),
(30613),
(306225),
(30643),
(306496),
(30655),
(306596),
(306688),
(306822),
(306963),
(307180),
(307265),
(30727),
(307375),
(307430),
(307501),
(30760),
(30763),
(30771),
(307782),
(307816),
(30785),
(307930),
(30795),
(30796),
(307982),
(308047),
(30820),
(308226),
(30822601),
(30823371),
(30834687),
(30839),
(308402),
(30843),
(308492871),
(308582),
(308587101),
(30860),
(308678),
(308806),
(308973),
(309122562),
(309162),
(309250887),
(309400),
(309456),
(309606),
(309681),
(309779),
(3097815),
(309845),
(30992759),
(309966),
(310076),
(310078),
(310240),
(310310),
(3103259),
(3103615),
(31046),
(31063165),
(310667),
(310736),
(310857479),
(3109188),
(310955),
(311239),
(311453),
(31148),
(31152),
(31153),
(311679),
(311760),
(3117990),
(311820),
(31186),
(31197),
(31217),
(312427),
(312648),
(31267),
(312769),
(312795578),
(31283),
(3128326),
(3128334),
(312949),
(313031),
(313055),
(313134),
(313220),
(31324),
(3132512),
(3133890),
(313393),
(313461),
(31348),
(313506),
(313509),
(31365),
(313734),
(313784),
(31380),
(31390),
(313947),
(314057),
(314312),
(314515),
(31463),
(314690),
(314750),
(31476),
(314842),
(314896),
(314960),
(31498),
(314995),
(31500),
(315117),
(315149),
(315210),
(315260),
(315394),
(3154614),
(315638543),
(315756),
(31577),
(31585),
(315884),
(3159732),
(316001),
(3160269),
(3163101),
(316367),
(31637),
(31670),
(316760073),
(316829),
(316877),
(3169998),
(317037),
(317227),
(31726),
(3173937),
(317519),
(317557),
(317627),
(317668),
(31772),
(317975),
(318049),
(318091),
(3181355),
(3182334),
(318505463),
(31864),
(318820),
(3188545),
(3188722),
(31900),
(319092),
(319157),
(319205),
(31926),
(319334),
(319384),
(319450),
(319532),
(319534),
(31973),
(3197334),
(3197361),
(3198565),
(3198633),
(3198786),
(3198815),
(320039344),
(320082),
(320105),
(32012),
(320141334),
(320186),
(320269),
(320303),
(320333),
(320371),
(32052),
(320570),
(32068),
(32073),
(320908),
(321180),
(321244),
(32137),
(321590),
(321778),
(32181),
(32184),
(322091),
(322121),
(32215),
(3222595),
(322298),
(322481),
(32265),
(322735),
(322777),
(322867),
(32290),
(32305),
(32307),
(323175),
(32352),
(323532),
(32356),
(323746),
(323756013),
(323857),
(32389646),
(32401),
(32410),
(324289),
(324452),
(32464),
(32471),
(32530),
(325333),
(32538),
(325428),
(32561),
(325619),
(325643),
(325771),
(32583),
(32588621),
(32590567),
(32596),
(32605),
(32638),
(326382),
(32657),
(326614),
(326838),
(327025),
(32710),
(32717),
(327291),
(327353),
(327408),
(327436),
(327460),
(3274917),
(32768),
(327735),
(327880),
(328190),
(32830),
(328377),
(32854),
(32855017),
(328571),
(328799),
(328874),
(32893341),
(3289679),
(32901),
(329083),
(329141),
(32919),
(329202),
(329287),
(32978),
(329891),
(329935),
(330043),
(330123),
(330170),
(330325),
(330453),
(330589),
(330661),
(33067),
(330672765),
(33080),
(331205),
(33127),
(331298),
(33130),
(331334),
(331476),
(331701),
(33174798),
(33180),
(33184),
(331949),
(332172),
(332250),
(332273),
(332311),
(332358),
(332476),
(332500),
(33254),
(332646),
(332700),
(332730),
(332954),
(33303923),
(333191),
(333273375),
(33328),
(333294),
(333332),
(333701),
(333765),
(333835),
(33384931),
(33386),
(333920),
(33398),
(33402796),
(33405327),
(334158),
(33420),
(334221),
(33424519),
(334367),
(33447962),
(334622),
(33493),
(335019),
(33509),
(33509757),
(33510148),
(33530),
(335306),
(33543),
(33560),
(33574),
(335798),
(335919),
(33593027),
(335973),
(336027),
(33604),
(336160),
(336277),
(33636),
(336458),
(336520),
(33679),
(33710),
(33715),
(337183),
(33764),
(33765),
(33769),
(337694),
(337708),
(33797),
(338018),
(33813),
(338134),
(33821),
(338214),
(338287),
(33832624),
(338403),
(338454),
(338513),
(338612),
(338729),
(33880),
(338943),
(33897),
(33926),
(339305),
(33931),
(339407),
(339447),
(339482),
(33950),
(33956),
(33982),
(339972),
(34001),
(340230),
(340272),
(34032),
(34039),
(340391),
(34048601),
(3405946),
(34067),
(34071),
(34071196),
(340736),
(34074951),
(34095687),
(341326),
(34138),
(341395),
(341530),
(341584),
(34177),
(341990),
(34219),
(34225),
(342453),
(34265589),
(34284),
(34306),
(343086),
(34335),
(34345),
(34378),
(343802),
(344112),
(344249),
(344284),
(344489),
(344562930),
(34490826),
(3449701),
(3451109),
(345779),
(34590),
(346012),
(346068),
(34611),
(346200),
(346270),
(346334),
(34640),
(346489),
(34682),
(34698),
(347035),
(34705),
(34709),
(347306),
(3473779),
(34740),
(34745),
(347535),
(347586),
(34765897),
(34768),
(3478354),
(347983),
(3479948),
(348016),
(34817),
(348238),
(348748),
(34874958),
(348788),
(34883),
(348835),
(348893),
(34917),
(34952431),
(34970103),
(349721),
(34990),
(34999),
(35000),
(35001),
(35003),
(35013),
(350153),
(350185),
(350318),
(350381),
(350405),
(350475),
(350503),
(350975),
(351162),
(352094),
(352350),
(35245481),
(35246128),
(35259),
(352620),
(352674),
(352769),
(352851),
(35298),
(353020),
(35303),
(353073),
(35312),
(353216),
(353253),
(35343499),
(353508),
(353867),
(35418),
(35426),
(35436),
(354361),
(35443),
(3545047),
(3547368),
(35475),
(35511785),
(355279),
(355432),
(355505),
(35576),
(355859),
(35600),
(35604),
(356133),
(35623987),
(356264),
(35631),
(3563798),
(35644),
(35647020),
(35648556),
(35650),
(35652),
(356618),
(356725),
(35695),
(356983),
(3572148),
(357301),
(35773),
(35806),
(35839),
(358694),
(3587084),
(35901),
(359017),
(3590733),
(35921712),
(35922),
(359339),
(35962803),
(359638),
(3596787),
(36005),
(36012134),
(360124),
(36013),
(36018),
(36033),
(36040),
(360416),
(3606161),
(36070),
(360791),
(36098),
(361068),
(361133),
(36122),
(361335),
(36146),
(361523),
(361617),
(361972),
(362000),
(36213),
(36214016),
(36216),
(36218),
(362220),
(36235),
(36265),
(362798),
(363003),
(363049),
(36318),
(363263),
(3632895),
(363597),
(363811),
(36398),
(364040),
(36437),
(36451),
(364700),
(364744),
(36476295),
(36478),
(3648194),
(36492),
(365013),
(36507),
(36508),
(365092),
(365114),
(365138),
(36536),
(365436),
(36551281),
(365997),
(36602),
(36610),
(3661558),
(36616),
(366230),
(36627),
(366314),
(36633475),
(36652),
(367118),
(36731),
(36762),
(367749),
(36776),
(36787),
(368278),
(368470),
(368607),
(36873737),
(368787),
(369346816),
(370017),
(370122),
(370413),
(370714),
(370857),
(371065),
(3711992),
(371281),
(371481),
(371856),
(372526),
(3732086),
(373264),
(3735944),
(373691),
(373702),
(374377),
(375780),
(37644463),
(376695),
(376921),
(376941),
(37709),
(377361),
(377732),
(3778171),
(377837),
(378088),
(378225),
(378537),
(378719),
(378755),
(378915),
(379037),
(379153),
(379493),
(379819),
(37995045),
(380011),
(38043467),
(38043973),
(380521),
(381068),
(381324),
(381591),
(381848),
(381997),
(382071),
(382127),
(382553),
(382724),
(383410),
(383754),
(384253),
(384381),
(384522),
(384639),
(384687),
(38572588),
(385872),
(385920),
(38610394),
(386225),
(386287),
(386289),
(386673),
(387097),
(387127),
(387513),
(387568),
(388397),
(388763),
(388819),
(38893720),
(389218),
(38933807),
(389726),
(390157),
(390225),
(391396),
(39153321),
(392731),
(392966),
(39348049),
(393488),
(393940),
(394038),
(394083),
(39413743),
(394466),
(394524),
(395442),
(39558105),
(395750),
(396177),
(396263),
(396353),
(397052),
(397072),
(397138),
(397414),
(397508),
(398144),
(398351),
(398549),
(398674),
(398784),
(399023),
(399117),
(399147),
(399217),
(399407),
(399462),
(399584),
(399700),
(399960),
(400224),
(400280),
(40084670),
(4008586),
(401541),
(401890),
(4026446),
(4027729),
(402971),
(402993),
(403719),
(404061),
(404105),
(404476),
(404682),
(40489588),
(405201),
(405257),
(405277),
(405465),
(405779),
(405869),
(406338),
(406606),
(406706),
(406896),
(407024),
(4080778),
(409424),
(410364),
(4107517),
(411220),
(411254),
(411342),
(411576),
(411950),
(411996),
(4120015),
(412052),
(412450),
(412632),
(413188),
(413190),
(413544),
(413831),
(413857),
(415352),
(4155690),
(415798),
(4161770),
(4163332),
(416404),
(4165287),
(41694753),
(417206),
(4180463),
(4182538),
(4184604),
(419781),
(4204488),
(4212820),
(4222231),
(422760),
(4233177),
(4235187),
(424556),
(424735),
(424885),
(4249970),
(4273768),
(42741660),
(42757816),
(4277008),
(4277141),
(4277236),
(4279240),
(4282491),
(4291896),
(4303924),
(4306112),
(4347554),
(43528096),
(435998),
(4368282),
(4368532),
(4370094),
(43960896),
(4420411),
(4422197),
(44459271),
(44709159),
(4481293),
(4485863),
(4492976),
(4497349),
(4497433),
(4508880),
(4528419),
(4544094),
(4567986),
(45987976),
(4613444),
(4640784),
(47054664),
(4730973),
(47371679),
(4741083),
(47411570),
(47531149),
(4773926),
(4800830),
(4803544),
(4860367),
(4876557),
(48809313),
(48853897),
(4890306),
(48933961),
(48993116),
(49276069),
(4932759),
(4940151),
(4993771),
(4997563),
(50206680),
(502751),
(5027624),
(5092377),
(51185930),
(515275),
(515923),
(517300),
(51738175),
(518638),
(518807),
(519411),
(520217),
(523176),
(526475),
(526573),
(526813),
(526921),
(526950),
(527252),
(527317),
(527364),
(527542),
(527596),
(527692),
(528325),
(528410),
(528414),
(528420),
(528955),
(53262489),
(5381745),
(5395961),
(5419323),
(5422066),
(5480744),
(5491205),
(553033),
(556909),
(5600655),
(588096),
(59036089),
(59049563),
(59151858),
(59220391),
(59503383),
(596117),
(598651),
(598666),
(598671),
(598689),
(598766),
(598808),
(6020983),
(6036497),
(603843),
(607483),
(61036),
(61177529),
(61199),
(61206100),
(61243),
(61292),
(6158729),
(61690445),
(617309),
(617490),
(61761808),
(6184168),
(6184525),
(618558),
(6186258),
(618908),
(61967803),
(619981),
(621806),
(621918),
(6227448),
(62541018),
(62670872),
(631759),
(6330458),
(642957),
(643621),
(6439171),
(645715),
(645776),
(6463398),
(6464151),
(6469353),
(6476441),
(6477196),
(6491293),
(655308),
(655542),
(655659),
(6565801),
(6569181),
(658507),
(658616),
(658767),
(6628356),
(66289856),
(6631173),
(664429),
(666631),
(6670721),
(675577),
(6757990),
(677376),
(677601),
(679139),
(679630),
(681029),
(682252),
(683720),
(6868151),
(687117),
(687140),
(687261),
(6886820),
(688713),
(6890373),
(689588),
(6904040),
(6908954),
(69189070),
(694640),
(695089),
(695204),
(695247),
(696281),
(696647),
(697701),
(7009878),
(701143),
(701179),
(704634),
(705287),
(705790),
(7131811),
(71456863),
(714668),
(715240),
(7195658),
(72526252),
(728889),
(731313),
(731580),
(734078),
(734865),
(738400),
(739115),
(739693),
(739698),
(742365),
(744526),
(745257),
(7471769),
(7489861),
(752915),
(754046),
(754881),
(7620997),
(7642030),
(7654173),
(7657914),
(765841),
(7662427),
(7665877),
(7666044),
(7668333),
(7670016),
(7675730),
(7683151),
(7685238),
(7704259),
(7731428),
(779331),
(7797659),
(780053),
(7818664),
(78749412),
(7910540),
(79161058),
(7918123),
(792424),
(79277661),
(794857),
(795040),
(7958431),
(7959935),
(8032784),
(805302),
(805585),
(8057672),
(8059421),
(8063879),
(8100663),
(810569),
(8122428),
(813573),
(813574),
(816889),
(819163),
(821389),
(82392972),
(8251223),
(8275373),
(8285048),
(831552),
(832494),
(838923),
(83920810),
(841205),
(841685),
(844756),
(854654),
(8591867),
(8610803),
(862598),
(862673),
(864032),
(873636),
(873641),
(873644),
(873648),
(873664),
(873695),
(873739),
(873742),
(873777),
(873792),
(873801),
(873804),
(873811),
(873813),
(873829),
(873832),
(873865),
(873874),
(873878),
(873897),
(873908),
(873917),
(873959),
(8740684),
(874078),
(874091),
(874125),
(874183),
(874190),
(874204),
(874249),
(874387),
(874480),
(874520),
(874645),
(874793),
(874827),
(874940),
(874988),
(875094),
(875120),
(875260),
(875334),
(875371),
(875453),
(875502),
(875568),
(875575),
(875612),
(875715),
(875838),
(875860),
(876006),
(876060),
(876067),
(876162),
(876199),
(876290),
(876323),
(876449),
(876577),
(876653),
(876661),
(876815),
(876861),
(877188),
(877270),
(877301),
(877535),
(877972),
(877990),
(878056),
(878093),
(878219),
(878373),
(878612),
(878615),
(879180),
(8793945),
(879555),
(879581),
(879730),
(879806),
(880059),
(880071),
(880193),
(880235),
(880251),
(880253),
(880287),
(880295),
(880311),
(880318),
(880393),
(880420),
(880494),
(880530),
(881094),
(881137),
(881155),
(881184),
(881203),
(881219),
(881300),
(881317),
(881367),
(881381),
(881409),
(881426),
(881430),
(881518),
(881624),
(882007),
(882041),
(882217),
(882318),
(882380),
(882569),
(882696),
(882767),
(882769),
(882794),
(882855),
(882937),
(882943),
(882950),
(883129),
(883197),
(8840403),
(884393),
(884401),
(887314),
(890498),
(89450),
(89538),
(896851),
(89809),
(9003256),
(9026347),
(90393),
(9051877),
(909408),
(91031),
(91092),
(91093),
(91192),
(915425),
(91675),
(91774),
(91797),
(9179990),
(91800),
(91823),
(91825),
(91868),
(92274),
(9247431),
(92578),
(92629),
(92639),
(92699),
(92716),
(92757),
(92768),
(9277653),
(92817),
(9282918),
(92852),
(92866),
(93024),
(93025),
(93026),
(93027),
(93028),
(93030),
(9306827),
(93196),
(93323),
(93339),
(93396),
(93425),
(93488),
(93547),
(93614),
(93624),
(93625),
(9363618),
(93904),
(94104),
(94188),
(94192),
(94197),
(94238),
(94243),
(94412),
(9444413),
(94613),
(94614),
(94728),
(94734),
(94799),
(94877),
(95153),
(95164),
(9525280),
(9532739),
(955392),
(955448),
(956269),
(95673),
(9573447),
(958929),
(9589732),
(95993),
(960673),
(96078),
(96079),
(96086),
(96161),
(9617257),
(9620336),
(96760),
(9681063),
(97023),
(97199),
(972115),
(972117),
(97423),
(9748502),
(97487),
(976038),
(97706),
(97928),
(97957),
(97965),
(981598),
(98186),
(98232368),
(983017),
(983307),
(98506),
(98509),
(98514),
(985438),
(98803),
(9885878),
(9885902),
(98873),
(98885),
(98924),
(9913586),
(9917384),
(99186),
(9956099),
(9962209),
(99856262),
(998579))
and [pricingDate] BETWEEN '1/1/2005' AND @evalDate
"""

mktcap = pandas.io.sql.read_sql(sql, ciqdb)
mktcap = mktcap.set_index(['companyid'])
#%%                               
                        
sql = """
set NOCOUNT ON

SELECT co.[companyId],cs.[symbolId],[symbolTypeId],[symbolValue],cs.[exchangeId],cs.[objectId],cs.[symbolStartDate],cs.[symbolEndDate],cs.[activeFlag]
FROM [CompustatData].[dbo].[ciqCompany] co
left join [CompustatData].[dbo].[ciqSecurity] se on se.[companyId] = co.[companyId]
left join [CompustatData].[dbo].[ciqTradingItem] ti on ti.securityId = se.securityId
left join [CompustatData].[dbo].[ciqSymbol] cs on ti.[tradingItemId] = cs.[objectId] and cs.[exchangeId] = ti.[exchangeId]
where co.[companyId] in ((10004874),
(100058833),
(1002291),
(100231),
(1002357),
(10028455),
(10040674),
(1004106),
(100410633),
(100440),
(100489288),
(100537),
(1006484),
(100787816),
(10081196),
(100918),
(100934),
(100937),
(1011775),
(101992492),
(10214722),
(102169),
(102267652),
(102348),
(1027055),
(1032802),
(103284),
(103375),
(103518),
(103599),
(103678),
(1038312),
(1038325),
(1038327),
(1038355),
(1038362),
(1039587),
(10404838),
(1040657),
(104643),
(104673),
(10494135),
(1050056),
(1051325),
(105291345),
(105612),
(1057473),
(105768270),
(105841183),
(1059251),
(106335),
(1064020),
(106426),
(106437),
(106485352),
(106530929),
(106577),
(106636),
(1066957),
(106772),
(1067744),
(106987),
(10739227),
(107405),
(107633),
(10779727),
(107911),
(108253),
(108522),
(108544),
(108616),
(108839),
(108856),
(109103),
(109131),
(109136),
(109300),
(10969688),
(110001),
(110044279),
(110741),
(11113129),
(111314384),
(111358),
(11147204),
(111790273),
(11207402),
(112165),
(112302),
(112305),
(112350),
(113073),
(113131),
(113541117),
(11365458),
(113665065),
(11382658),
(113922672),
(113970207),
(114039),
(114063305),
(1141723),
(11420997),
(11478068),
(114823784),
(115032605),
(115102487),
(11515826),
(115779020),
(117842106),
(117912488),
(118218449),
(118315802),
(11857151),
(118605496),
(11888172),
(11902093),
(119033497),
(119902),
(120262),
(120285),
(120367),
(120406),
(120622),
(120623),
(120909),
(121238),
(121246),
(121483),
(121509),
(121534),
(121729),
(121767),
(122212),
(122699),
(122917),
(12296252),
(12297011),
(123217),
(12344550),
(123891),
(1239256),
(1241057),
(124219),
(124243),
(124307),
(124321),
(124423),
(124565),
(124878),
(12518001),
(125228),
(12534920),
(125757),
(1261061),
(126269),
(12633071),
(126362),
(126411),
(12666489),
(126668),
(126921),
(127095032),
(12719228),
(12722790),
(127583),
(127694719),
(127719),
(127881),
(127918),
(128209),
(12826523),
(128540),
(128584),
(128845270),
(129318),
(129396129),
(129679427),
(130258307),
(13061287),
(130689),
(130705),
(130863),
(13103664),
(131112810),
(131731858),
(13190293),
(132077212),
(133282),
(13356885),
(1340740),
(1340741),
(134106179),
(1341470),
(1341753),
(1342556),
(1342560),
(1343561),
(134603330),
(1348220),
(134992),
(13529856),
(13529992),
(135311),
(135443),
(135470),
(135474),
(13627017),
(136333),
(136356),
(13639172),
(136442),
(13649709),
(137240118),
(137304893),
(137411),
(137473239),
(13756315),
(13757558),
(137649125),
(138296738),
(138613332),
(139317925),
(139431),
(139488),
(139673),
(139677),
(139813),
(139997035),
(140233),
(140283),
(140950927),
(141108755),
(1413204),
(1413208),
(141581761),
(141827503),
(141885706),
(141930906),
(142250097),
(1425530),
(142670771),
(142879),
(142892259),
(144258),
(144405183),
(145116275),
(145625476),
(145737384),
(1458681),
(1462309),
(1494343),
(1495607),
(1519864),
(1528824),
(1533412),
(1534795),
(154054449),
(1541811),
(1543272),
(1543637),
(154924),
(155172),
(1565109),
(1566745),
(157028),
(1570880),
(1587862),
(159230),
(160077),
(160180),
(160197),
(160233),
(1611542),
(162270),
(163087),
(163111),
(164034),
(165298),
(166314),
(166457),
(1666001),
(166802),
(167945),
(168151),
(168154),
(168182),
(1683286),
(168569),
(168864),
(169142),
(169308),
(169838),
(1699197),
(170198295),
(170245760),
(170260),
(170352),
(170571),
(170928919),
(171106),
(171116),
(171445),
(171604),
(171649),
(171737),
(1717518),
(172055),
(172131),
(172207),
(172472),
(172899),
(173094),
(173341),
(173840),
(173927),
(174336),
(174438),
(174901),
(175110),
(175265),
(175480),
(1756150),
(175749),
(176102),
(176159),
(176787),
(177031),
(177126),
(177251),
(177500),
(177698),
(177934),
(178254),
(178296),
(178946),
(178976),
(1789909),
(1790684),
(179862),
(180871),
(181003),
(181176),
(181478),
(181943700),
(182505),
(182707),
(182949),
(183089),
(183811756),
(184128240),
(184157327),
(1843135),
(184841),
(184945),
(18527),
(185333),
(185508),
(185801),
(18671),
(186785),
(18749),
(1876050),
(188244),
(188335),
(188477),
(188653),
(189096),
(189282),
(189424),
(189426),
(189526),
(189539),
(189848),
(19007),
(190137),
(190268),
(190358),
(190489),
(190636),
(190694),
(190756),
(190786),
(190876),
(19095),
(190965),
(191013),
(191216),
(191328),
(191564),
(191884),
(192089),
(19209),
(192186),
(1921896),
(1925656),
(1944751),
(195901),
(19609),
(19691),
(1974492),
(197773),
(19839),
(199022),
(200128),
(200199),
(20119),
(203002),
(203101),
(204710830),
(20496676),
(20522974),
(20523038),
(205233),
(20531152),
(20571),
(20721550),
(207221),
(20801430),
(20963),
(2102034),
(210392),
(21127),
(21171),
(2125636),
(212766522),
(213048879),
(213879),
(214103601),
(2141734),
(215339359),
(215342183),
(215548781),
(21609),
(216313883),
(216581935),
(2168124),
(217389033),
(217503),
(21835),
(21842239),
(218812),
(21919911),
(219437),
(21954621),
(220168),
(22039608),
(22077696),
(22183895),
(22236226),
(22238416),
(222402013),
(222406786),
(22247),
(222554189),
(22261533),
(22298592),
(22357184),
(2238172),
(22385966),
(224003614),
(22413056),
(224325923),
(224946128),
(225078297),
(22511),
(22548461),
(225523981),
(22603885),
(22614982),
(226200263),
(226530250),
(226584812),
(22666093),
(226898),
(22691841),
(22747149),
(22751),
(22768589),
(22771433),
(22800180),
(22805),
(228070761),
(22848913),
(228755),
(22883846),
(22920207),
(22929077),
(22967487),
(23013),
(230297),
(23046303),
(23081173),
(2312985),
(231688165),
(231691952),
(232036063),
(232335127),
(23270929),
(23287),
(233427056),
(233582617),
(23374622),
(23499518),
(23500974),
(23553263),
(23557),
(23626080),
(23644436),
(23682136),
(23702309),
(237656125),
(23812789),
(23815047),
(2381717),
(23838378),
(238570),
(23873120),
(23939254),
(24003473),
(24043),
(240460878),
(2405489),
(240792646),
(24080914),
(240823191),
(24085),
(240936085),
(24114004),
(2413126),
(241463154),
(241494537),
(24154988),
(24165),
(241709041),
(241738548),
(241782379),
(24202),
(242099548),
(24225),
(24246),
(24249112),
(242798179),
(24281),
(24292),
(24321),
(24333),
(2433584),
(24362),
(243649654),
(24368),
(243685275),
(243685856),
(243907022),
(244370933),
(24442),
(24443077),
(244741443),
(24494),
(24504),
(24505),
(24522),
(245507),
(245786818),
(24603),
(24604),
(246100779),
(24620),
(246279126),
(246545),
(24658),
(246886),
(24689),
(247017859),
(247026262),
(24704),
(247170),
(247198),
(247261058),
(24732),
(247347),
(247371),
(24738407),
(247483),
(24753),
(247574887),
(24758),
(247593650),
(24766),
(24771),
(247782),
(24779),
(247842371),
(24801),
(24804),
(24809),
(2481334),
(24816),
(24821),
(248256),
(24827),
(248270),
(248356),
(2483732),
(24842),
(248450),
(24846),
(248501),
(248608),
(248655),
(24879),
(248823),
(248858755),
(24886525),
(248869),
(2488839),
(248916),
(24893),
(249061912),
(249110868),
(249126),
(249205),
(249319773),
(24937),
(249436),
(24950477),
(249603),
(24967),
(249726),
(24980220),
(249841),
(24985251),
(249925),
(24994),
(249999),
(250037),
(250079),
(25026),
(250312),
(250388),
(25039993),
(25046),
(250532),
(250592),
(25063),
(25080),
(250859),
(2508590),
(250885),
(25090458),
(25109),
(251230),
(251258),
(25134),
(251349),
(251411),
(251475),
(251704),
(251719973),
(251849),
(25191),
(252088241),
(252150),
(2522534),
(252257),
(252339),
(2523864),
(252431),
(252517),
(252551),
(252684),
(252743080),
(2527714),
(252978),
(253018),
(25304),
(25307),
(253076),
(253132),
(253239200),
(25334),
(253388),
(2534215),
(253561),
(2535666),
(253702),
(253706543),
(253730),
(25403751),
(254131),
(254193),
(254287707),
(25447),
(254497048),
(254571),
(25460099),
(254725),
(25478219),
(254847),
(25489),
(254965),
(255055),
(255132),
(255251),
(255397),
(255524),
(255627),
(2557009),
(25572071),
(255743),
(2557643),
(255781),
(255902),
(25605),
(256200),
(25643),
(256487722),
(256523),
(256558670),
(256689),
(25673),
(256839),
(256893),
(25708),
(257151),
(257198),
(257424),
(257568),
(257682),
(25776),
(25777),
(257948),
(25798),
(25812479),
(258133),
(25820),
(25823),
(258278),
(25836053),
(25839),
(258458),
(258532),
(258589),
(25864),
(258769),
(258791),
(258823),
(258891),
(258937),
(25910408),
(25915843),
(259212),
(25922),
(259280),
(25933),
(25935),
(259378),
(25941),
(259589),
(259731),
(25981),
(259829),
(259957),
(260119),
(26014489),
(260149),
(260291),
(260414),
(260583),
(260619),
(26069),
(260725),
(26079217),
(260824267),
(260858),
(260920),
(261084576),
(261105),
(261171),
(26145),
(26145318),
(261461504),
(261467539),
(26147908),
(261596),
(26161),
(261738),
(26175),
(261825),
(261915062),
(261974),
(262033),
(26207),
(262247),
(26238),
(26239),
(26252),
(26259736),
(262639),
(26268),
(26273),
(26274),
(262788142),
(262857074),
(262913),
(262937),
(262961),
(263093),
(26322),
(26323),
(263232),
(26325966),
(263295),
(263339),
(263424),
(26351024),
(263515824),
(263568),
(263587669),
(263609),
(263765),
(263774786),
(26394),
(264048),
(264239134),
(26433812),
(26453),
(26470411),
(264707946),
(264815),
(26486),
(264897),
(26524),
(265253),
(265539),
(26556501),
(265621),
(26565),
(266017),
(266099),
(266112),
(266238),
(266311),
(26633),
(26642),
(266430),
(266510),
(266598),
(266664),
(26674),
(266745628),
(266767),
(26677),
(266907),
(266974),
(267105),
(267161),
(267304112),
(267344),
(2673708),
(267468),
(267555),
(2675671),
(26765),
(267761),
(26782),
(267850),
(267906),
(268053),
(268141),
(268363),
(26837),
(268503),
(26879202),
(26879258),
(268799),
(26893),
(26906),
(26911),
(269231),
(269271),
(269306),
(26934),
(269599),
(269660),
(269706),
(269764),
(26977),
(26991845),
(269924),
(270315),
(270395),
(270427),
(27049995),
(270586),
(270700),
(270820),
(27098),
(271077),
(27111),
(27129),
(271305),
(271329),
(27133),
(271353957),
(27168),
(27189),
(27191),
(27198),
(27199),
(272054403),
(27222327),
(27223),
(27236),
(27244),
(27271),
(27292837),
(272957),
(27306532),
(27307),
(273212),
(273276),
(273513334),
(27351387),
(273607),
(273981),
(273983758),
(274031831),
(274166),
(274265),
(274350),
(27440804),
(274419),
(27444752),
(27447874),
(274561),
(27460),
(27465),
(274715),
(274818),
(27490),
(27504),
(27508),
(275119),
(275201),
(275232),
(27526391),
(275400),
(275442),
(275547611),
(275573),
(275668),
(275789),
(27582),
(276006),
(276060),
(276190901),
(276209),
(27629813),
(27645),
(27655),
(276599),
(27672),
(27681),
(27685),
(27707),
(277444),
(27745),
(277517),
(27755),
(277563183),
(277575),
(277603),
(277617),
(27763231),
(277709),
(277746),
(277824630),
(277854),
(277894),
(277914),
(277966),
(277994),
(278111),
(27812059),
(278143),
(278212),
(278271),
(278341),
(278369),
(2783831),
(27842),
(27844),
(278446),
(278513),
(278553),
(278556),
(278576),
(27860587),
(27862),
(278679),
(278733),
(278765),
(27877),
(279042),
(27910),
(279167),
(279306),
(279402278),
(279513),
(279534),
(27963),
(27970),
(27973340),
(279750),
(279954),
(280123),
(28014),
(280211),
(280274078),
(28028),
(280322),
(280420),
(28045),
(280561),
(28061),
(28062),
(28071),
(28071116),
(280856),
(280910),
(280944),
(281121),
(281314),
(281407),
(281438),
(28151),
(281820),
(281893),
(281931),
(282005),
(28202),
(28209),
(282225),
(282415),
(282503),
(282539),
(282576),
(28258),
(282590),
(28274),
(282848),
(28291),
(282981),
(283024),
(283234),
(283356),
(28338),
(283410),
(283484),
(283757),
(28381),
(283857),
(28395),
(284137),
(284342),
(28434822),
(28448),
(284564),
(284668),
(284766),
(28479),
(284847),
(285038),
(285125),
(285250),
(28532),
(285325),
(285467),
(2855282),
(285544),
(28556),
(28561473),
(28565),
(285663),
(285827),
(285880),
(285930),
(28606),
(28610038),
(286119),
(286163),
(286180590),
(286187),
(2862715),
(286358),
(286411),
(28646680),
(28671),
(286798),
(286976),
(287043),
(28723),
(28754),
(28756),
(28764),
(287798),
(287950),
(287993),
(288033),
(288195),
(288255),
(288355),
(288502),
(28872678),
(28877),
(288924),
(289030),
(289194),
(289484),
(289620),
(289834),
(29002),
(290060),
(290177),
(290203),
(29031),
(29053039),
(290650),
(290681),
(290733),
(290757),
(2908516),
(290898),
(29096),
(291225),
(291250),
(291286),
(291333),
(29142),
(291518),
(291586),
(291619),
(291703),
(291795),
(2918450),
(291981),
(29204),
(292092),
(292135),
(292268),
(29232),
(29243),
(29252427),
(292525),
(29256),
(29272),
(292742),
(29279),
(29282),
(292826),
(292980),
(293286),
(29344),
(29346),
(293515),
(293569),
(29364),
(293645),
(293680),
(293711),
(29374),
(293889),
(293966),
(294006),
(294167),
(294269),
(294338),
(294382),
(294483),
(294550),
(2945619),
(294639),
(29470),
(294721),
(294799),
(294945),
(294957),
(294994),
(295080),
(29515572),
(295170),
(295224),
(29538),
(295565),
(295624),
(295660),
(29574),
(295915),
(295969),
(296104),
(296129),
(29617),
(29618),
(296181),
(296308),
(296511),
(296527),
(296568),
(296799),
(29685),
(296889),
(296917),
(296957),
(297018),
(297179),
(297210),
(29726),
(29728),
(29729),
(297294),
(297384),
(297463012),
(297526),
(29753),
(297545),
(297620),
(29762552),
(297660),
(297799),
(29780),
(297850),
(29794),
(298014),
(29814932),
(298176),
(2982993),
(2983116),
(2983403),
(298400),
(298441),
(298482),
(298571),
(298753),
(298950),
(298968),
(29902),
(299095),
(299263),
(29929),
(299515),
(29962),
(29963),
(29969),
(299702),
(30000),
(30009227),
(30012),
(300504),
(30061),
(300644),
(300794),
(300942),
(301040),
(301069),
(30116),
(30116605),
(30120841),
(30133),
(301580992),
(301667),
(301669938),
(3017691),
(30177530),
(301891),
(301966),
(30202),
(30205),
(302143),
(30223),
(30232680),
(30244916),
(302480),
(30253),
(302594),
(302617),
(302707),
(3027333),
(3027743),
(302907),
(30292),
(30300),
(303104),
(30323),
(303303),
(30336380),
(303397),
(30345),
(303526),
(303591),
(303646),
(303689323),
(30379),
(303828),
(303885),
(303923),
(30396158),
(304124),
(304195),
(30421),
(30422),
(304227),
(304260),
(304284),
(304285),
(304383),
(30439),
(30451),
(30472),
(30485592),
(304977),
(30506),
(305082),
(30511),
(30513),
(305213),
(305467),
(30547),
(30550),
(305583),
(30573),
(305749),
(30575),
(30591),
(306013),
(306072),
(30613),
(306225),
(30643),
(306496),
(30655),
(306596),
(306688),
(306822),
(306963),
(307180),
(307265),
(30727),
(307375),
(307430),
(307501),
(30760),
(30763),
(30771),
(307782),
(307816),
(30785),
(307930),
(30795),
(30796),
(307982),
(308047),
(30820),
(308226),
(30822601),
(30823371),
(30834687),
(30839),
(308402),
(30843),
(308492871),
(308582),
(308587101),
(30860),
(308678),
(308806),
(308973),
(309122562),
(309162),
(309250887),
(309400),
(309456),
(309606),
(309681),
(309779),
(3097815),
(309845),
(30992759),
(309966),
(310076),
(310078),
(310240),
(310310),
(3103259),
(3103615),
(31046),
(31063165),
(310667),
(310736),
(310857479),
(3109188),
(310955),
(311239),
(311453),
(31148),
(31152),
(31153),
(311679),
(311760),
(3117990),
(311820),
(31186),
(31197),
(31217),
(312427),
(312648),
(31267),
(312769),
(312795578),
(31283),
(3128326),
(3128334),
(312949),
(313031),
(313055),
(313134),
(313220),
(31324),
(3132512),
(3133890),
(313393),
(313461),
(31348),
(313506),
(313509),
(31365),
(313734),
(313784),
(31380),
(31390),
(313947),
(314057),
(314312),
(314515),
(31463),
(314690),
(314750),
(31476),
(314842),
(314896),
(314960),
(31498),
(314995),
(31500),
(315117),
(315149),
(315210),
(315260),
(315394),
(3154614),
(315638543),
(315756),
(31577),
(31585),
(315884),
(3159732),
(316001),
(3160269),
(3163101),
(316367),
(31637),
(31670),
(316760073),
(316829),
(316877),
(3169998),
(317037),
(317227),
(31726),
(3173937),
(317519),
(317557),
(317627),
(317668),
(31772),
(317975),
(318049),
(318091),
(3181355),
(3182334),
(318505463),
(31864),
(318820),
(3188545),
(3188722),
(31900),
(319092),
(319157),
(319205),
(31926),
(319334),
(319384),
(319450),
(319532),
(319534),
(31973),
(3197334),
(3197361),
(3198565),
(3198633),
(3198786),
(3198815),
(320039344),
(320082),
(320105),
(32012),
(320141334),
(320186),
(320269),
(320303),
(320333),
(320371),
(32052),
(320570),
(32068),
(32073),
(320908),
(321180),
(321244),
(32137),
(321590),
(321778),
(32181),
(32184),
(322091),
(322121),
(32215),
(3222595),
(322298),
(322481),
(32265),
(322735),
(322777),
(322867),
(32290),
(32305),
(32307),
(323175),
(32352),
(323532),
(32356),
(323746),
(323756013),
(323857),
(32389646),
(32401),
(32410),
(324289),
(324452),
(32464),
(32471),
(32530),
(325333),
(32538),
(325428),
(32561),
(325619),
(325643),
(325771),
(32583),
(32588621),
(32590567),
(32596),
(32605),
(32638),
(326382),
(32657),
(326614),
(326838),
(327025),
(32710),
(32717),
(327291),
(327353),
(327408),
(327436),
(327460),
(3274917),
(32768),
(327735),
(327880),
(328190),
(32830),
(328377),
(32854),
(32855017),
(328571),
(328799),
(328874),
(32893341),
(3289679),
(32901),
(329083),
(329141),
(32919),
(329202),
(329287),
(32978),
(329891),
(329935),
(330043),
(330123),
(330170),
(330325),
(330453),
(330589),
(330661),
(33067),
(330672765),
(33080),
(331205),
(33127),
(331298),
(33130),
(331334),
(331476),
(331701),
(33174798),
(33180),
(33184),
(331949),
(332172),
(332250),
(332273),
(332311),
(332358),
(332476),
(332500),
(33254),
(332646),
(332700),
(332730),
(332954),
(33303923),
(333191),
(333273375),
(33328),
(333294),
(333332),
(333701),
(333765),
(333835),
(33384931),
(33386),
(333920),
(33398),
(33402796),
(33405327),
(334158),
(33420),
(334221),
(33424519),
(334367),
(33447962),
(334622),
(33493),
(335019),
(33509),
(33509757),
(33510148),
(33530),
(335306),
(33543),
(33560),
(33574),
(335798),
(335919),
(33593027),
(335973),
(336027),
(33604),
(336160),
(336277),
(33636),
(336458),
(336520),
(33679),
(33710),
(33715),
(337183),
(33764),
(33765),
(33769),
(337694),
(337708),
(33797),
(338018),
(33813),
(338134),
(33821),
(338214),
(338287),
(33832624),
(338403),
(338454),
(338513),
(338612),
(338729),
(33880),
(338943),
(33897),
(33926),
(339305),
(33931),
(339407),
(339447),
(339482),
(33950),
(33956),
(33982),
(339972),
(34001),
(340230),
(340272),
(34032),
(34039),
(340391),
(34048601),
(3405946),
(34067),
(34071),
(34071196),
(340736),
(34074951),
(34095687),
(341326),
(34138),
(341395),
(341530),
(341584),
(34177),
(341990),
(34219),
(34225),
(342453),
(34265589),
(34284),
(34306),
(343086),
(34335),
(34345),
(34378),
(343802),
(344112),
(344249),
(344284),
(344489),
(344562930),
(34490826),
(3449701),
(3451109),
(345779),
(34590),
(346012),
(346068),
(34611),
(346200),
(346270),
(346334),
(34640),
(346489),
(34682),
(34698),
(347035),
(34705),
(34709),
(347306),
(3473779),
(34740),
(34745),
(347535),
(347586),
(34765897),
(34768),
(3478354),
(347983),
(3479948),
(348016),
(34817),
(348238),
(348748),
(34874958),
(348788),
(34883),
(348835),
(348893),
(34917),
(34952431),
(34970103),
(349721),
(34990),
(34999),
(35000),
(35001),
(35003),
(35013),
(350153),
(350185),
(350318),
(350381),
(350405),
(350475),
(350503),
(350975),
(351162),
(352094),
(352350),
(35245481),
(35246128),
(35259),
(352620),
(352674),
(352769),
(352851),
(35298),
(353020),
(35303),
(353073),
(35312),
(353216),
(353253),
(35343499),
(353508),
(353867),
(35418),
(35426),
(35436),
(354361),
(35443),
(3545047),
(3547368),
(35475),
(35511785),
(355279),
(355432),
(355505),
(35576),
(355859),
(35600),
(35604),
(356133),
(35623987),
(356264),
(35631),
(3563798),
(35644),
(35647020),
(35648556),
(35650),
(35652),
(356618),
(356725),
(35695),
(356983),
(3572148),
(357301),
(35773),
(35806),
(35839),
(358694),
(3587084),
(35901),
(359017),
(3590733),
(35921712),
(35922),
(359339),
(35962803),
(359638),
(3596787),
(36005),
(36012134),
(360124),
(36013),
(36018),
(36033),
(36040),
(360416),
(3606161),
(36070),
(360791),
(36098),
(361068),
(361133),
(36122),
(361335),
(36146),
(361523),
(361617),
(361972),
(362000),
(36213),
(36214016),
(36216),
(36218),
(362220),
(36235),
(36265),
(362798),
(363003),
(363049),
(36318),
(363263),
(3632895),
(363597),
(363811),
(36398),
(364040),
(36437),
(36451),
(364700),
(364744),
(36476295),
(36478),
(3648194),
(36492),
(365013),
(36507),
(36508),
(365092),
(365114),
(365138),
(36536),
(365436),
(36551281),
(365997),
(36602),
(36610),
(3661558),
(36616),
(366230),
(36627),
(366314),
(36633475),
(36652),
(367118),
(36731),
(36762),
(367749),
(36776),
(36787),
(368278),
(368470),
(368607),
(36873737),
(368787),
(369346816),
(370017),
(370122),
(370413),
(370714),
(370857),
(371065),
(3711992),
(371281),
(371481),
(371856),
(372526),
(3732086),
(373264),
(3735944),
(373691),
(373702),
(374377),
(375780),
(37644463),
(376695),
(376921),
(376941),
(37709),
(377361),
(377732),
(3778171),
(377837),
(378088),
(378225),
(378537),
(378719),
(378755),
(378915),
(379037),
(379153),
(379493),
(379819),
(37995045),
(380011),
(38043467),
(38043973),
(380521),
(381068),
(381324),
(381591),
(381848),
(381997),
(382071),
(382127),
(382553),
(382724),
(383410),
(383754),
(384253),
(384381),
(384522),
(384639),
(384687),
(38572588),
(385872),
(385920),
(38610394),
(386225),
(386287),
(386289),
(386673),
(387097),
(387127),
(387513),
(387568),
(388397),
(388763),
(388819),
(38893720),
(389218),
(38933807),
(389726),
(390157),
(390225),
(391396),
(39153321),
(392731),
(392966),
(39348049),
(393488),
(393940),
(394038),
(394083),
(39413743),
(394466),
(394524),
(395442),
(39558105),
(395750),
(396177),
(396263),
(396353),
(397052),
(397072),
(397138),
(397414),
(397508),
(398144),
(398351),
(398549),
(398674),
(398784),
(399023),
(399117),
(399147),
(399217),
(399407),
(399462),
(399584),
(399700),
(399960),
(400224),
(400280),
(40084670),
(4008586),
(401541),
(401890),
(4026446),
(4027729),
(402971),
(402993),
(403719),
(404061),
(404105),
(404476),
(404682),
(40489588),
(405201),
(405257),
(405277),
(405465),
(405779),
(405869),
(406338),
(406606),
(406706),
(406896),
(407024),
(4080778),
(409424),
(410364),
(4107517),
(411220),
(411254),
(411342),
(411576),
(411950),
(411996),
(4120015),
(412052),
(412450),
(412632),
(413188),
(413190),
(413544),
(413831),
(413857),
(415352),
(4155690),
(415798),
(4161770),
(4163332),
(416404),
(4165287),
(41694753),
(417206),
(4180463),
(4182538),
(4184604),
(419781),
(4204488),
(4212820),
(4222231),
(422760),
(4233177),
(4235187),
(424556),
(424735),
(424885),
(4249970),
(4273768),
(42741660),
(42757816),
(4277008),
(4277141),
(4277236),
(4279240),
(4282491),
(4291896),
(4303924),
(4306112),
(4347554),
(43528096),
(435998),
(4368282),
(4368532),
(4370094),
(43960896),
(4420411),
(4422197),
(44459271),
(44709159),
(4481293),
(4485863),
(4492976),
(4497349),
(4497433),
(4508880),
(4528419),
(4544094),
(4567986),
(45987976),
(4613444),
(4640784),
(47054664),
(4730973),
(47371679),
(4741083),
(47411570),
(47531149),
(4773926),
(4800830),
(4803544),
(4860367),
(4876557),
(48809313),
(48853897),
(4890306),
(48933961),
(48993116),
(49276069),
(4932759),
(4940151),
(4993771),
(4997563),
(50206680),
(502751),
(5027624),
(5092377),
(51185930),
(515275),
(515923),
(517300),
(51738175),
(518638),
(518807),
(519411),
(520217),
(523176),
(526475),
(526573),
(526813),
(526921),
(526950),
(527252),
(527317),
(527364),
(527542),
(527596),
(527692),
(528325),
(528410),
(528414),
(528420),
(528955),
(53262489),
(5381745),
(5395961),
(5419323),
(5422066),
(5480744),
(5491205),
(553033),
(556909),
(5600655),
(588096),
(59036089),
(59049563),
(59151858),
(59220391),
(59503383),
(596117),
(598651),
(598666),
(598671),
(598689),
(598766),
(598808),
(6020983),
(6036497),
(603843),
(607483),
(61036),
(61177529),
(61199),
(61206100),
(61243),
(61292),
(6158729),
(61690445),
(617309),
(617490),
(61761808),
(6184168),
(6184525),
(618558),
(6186258),
(618908),
(61967803),
(619981),
(621806),
(621918),
(6227448),
(62541018),
(62670872),
(631759),
(6330458),
(642957),
(643621),
(6439171),
(645715),
(645776),
(6463398),
(6464151),
(6469353),
(6476441),
(6477196),
(6491293),
(655308),
(655542),
(655659),
(6565801),
(6569181),
(658507),
(658616),
(658767),
(6628356),
(66289856),
(6631173),
(664429),
(666631),
(6670721),
(675577),
(6757990),
(677376),
(677601),
(679139),
(679630),
(681029),
(682252),
(683720),
(6868151),
(687117),
(687140),
(687261),
(6886820),
(688713),
(6890373),
(689588),
(6904040),
(6908954),
(69189070),
(694640),
(695089),
(695204),
(695247),
(696281),
(696647),
(697701),
(7009878),
(701143),
(701179),
(704634),
(705287),
(705790),
(7131811),
(71456863),
(714668),
(715240),
(7195658),
(72526252),
(728889),
(731313),
(731580),
(734078),
(734865),
(738400),
(739115),
(739693),
(739698),
(742365),
(744526),
(745257),
(7471769),
(7489861),
(752915),
(754046),
(754881),
(7620997),
(7642030),
(7654173),
(7657914),
(765841),
(7662427),
(7665877),
(7666044),
(7668333),
(7670016),
(7675730),
(7683151),
(7685238),
(7704259),
(7731428),
(779331),
(7797659),
(780053),
(7818664),
(78749412),
(7910540),
(79161058),
(7918123),
(792424),
(79277661),
(794857),
(795040),
(7958431),
(7959935),
(8032784),
(805302),
(805585),
(8057672),
(8059421),
(8063879),
(8100663),
(810569),
(8122428),
(813573),
(813574),
(816889),
(819163),
(821389),
(82392972),
(8251223),
(8275373),
(8285048),
(831552),
(832494),
(838923),
(83920810),
(841205),
(841685),
(844756),
(854654),
(8591867),
(8610803),
(862598),
(862673),
(864032),
(873636),
(873641),
(873644),
(873648),
(873664),
(873695),
(873739),
(873742),
(873777),
(873792),
(873801),
(873804),
(873811),
(873813),
(873829),
(873832),
(873865),
(873874),
(873878),
(873897),
(873908),
(873917),
(873959),
(8740684),
(874078),
(874091),
(874125),
(874183),
(874190),
(874204),
(874249),
(874387),
(874480),
(874520),
(874645),
(874793),
(874827),
(874940),
(874988),
(875094),
(875120),
(875260),
(875334),
(875371),
(875453),
(875502),
(875568),
(875575),
(875612),
(875715),
(875838),
(875860),
(876006),
(876060),
(876067),
(876162),
(876199),
(876290),
(876323),
(876449),
(876577),
(876653),
(876661),
(876815),
(876861),
(877188),
(877270),
(877301),
(877535),
(877972),
(877990),
(878056),
(878093),
(878219),
(878373),
(878612),
(878615),
(879180),
(8793945),
(879555),
(879581),
(879730),
(879806),
(880059),
(880071),
(880193),
(880235),
(880251),
(880253),
(880287),
(880295),
(880311),
(880318),
(880393),
(880420),
(880494),
(880530),
(881094),
(881137),
(881155),
(881184),
(881203),
(881219),
(881300),
(881317),
(881367),
(881381),
(881409),
(881426),
(881430),
(881518),
(881624),
(882007),
(882041),
(882217),
(882318),
(882380),
(882569),
(882696),
(882767),
(882769),
(882794),
(882855),
(882937),
(882943),
(882950),
(883129),
(883197),
(8840403),
(884393),
(884401),
(887314),
(890498),
(89450),
(89538),
(896851),
(89809),
(9003256),
(9026347),
(90393),
(9051877),
(909408),
(91031),
(91092),
(91093),
(91192),
(915425),
(91675),
(91774),
(91797),
(9179990),
(91800),
(91823),
(91825),
(91868),
(92274),
(9247431),
(92578),
(92629),
(92639),
(92699),
(92716),
(92757),
(92768),
(9277653),
(92817),
(9282918),
(92852),
(92866),
(93024),
(93025),
(93026),
(93027),
(93028),
(93030),
(9306827),
(93196),
(93323),
(93339),
(93396),
(93425),
(93488),
(93547),
(93614),
(93624),
(93625),
(9363618),
(93904),
(94104),
(94188),
(94192),
(94197),
(94238),
(94243),
(94412),
(9444413),
(94613),
(94614),
(94728),
(94734),
(94799),
(94877),
(95153),
(95164),
(9525280),
(9532739),
(955392),
(955448),
(956269),
(95673),
(9573447),
(958929),
(9589732),
(95993),
(960673),
(96078),
(96079),
(96086),
(96161),
(9617257),
(9620336),
(96760),
(9681063),
(97023),
(97199),
(972115),
(972117),
(97423),
(9748502),
(97487),
(976038),
(97706),
(97928),
(97957),
(97965),
(981598),
(98186),
(98232368),
(983017),
(983307),
(98506),
(98509),
(98514),
(985438),
(98803),
(9885878),
(9885902),
(98873),
(98885),
(98924),
(9913586),
(9917384),
(99186),
(9956099),
(9962209),
(99856262),
(998579))
and symbolTypeId in (15, 21, 5701) --CUSIP, ISIN, SEDOL
and cs.activeFlag = 1
and se.primaryFlag = 1
and cs.exchangeid in (106, 102, 458, 104, 173, 14, 18, 477)
order by co.[companyId],cs.[symbolId]
"""

symbol = pandas.io.sql.read_sql(sql, ciqdb)
#%%
nim = pd.read_excel(r'Q:\Debt Issue Study\New Issue Monitor Test_Python.xlsx', 'Screening', na_values=['NA'])
#%%
lifecycle = pd.read_excel(r'Q:\Debt Issue Study\Debt_Equity_Study_MASTER.xlsx', 'Lifecycle', na_values=['NA'])
spx = pd.read_excel(r'Q:\Debt Issue Study\Debt_Equity_Study_MASTER.xlsx', 'SPX', na_values=['NA'])

#%%
matrix = company[['gvkey','companyid','companyname','simpleindustrydescription']].copy(deep=True)
issuer = pd.merge(matrix, nim, left_on=['companyid'], right_on = ['IssuerID'],how='outer')
issuerpar = pd.merge(matrix, nim, left_on=['companyid'], right_on = ['IssuerParentID'],how='outer')
ultpar = pd.merge(matrix, nim, left_on=['companyid'], right_on = ['UltimateParentID'],how='outer')
issuer = issuer.dropna(how='any')
issuer = issuer.drop_duplicates()
issuerpar = issuerpar.dropna(how='any')
issuerpar = issuerpar.drop_duplicates()
ultpar = ultpar.dropna(how='any')
ultpar = ultpar.drop_duplicates()
frames = [issuer, issuerpar, ultpar]
matrix2 = pd.concat(frames)
del matrix2['SecurityID']
matrix2 = matrix2.dropna(how='any')
matrix2 = matrix2.drop_duplicates()
matrix2['testyear'] = pd.DatetimeIndex(matrix2['OfferingDate']).year
matrix2['testmonth'] = pd.DatetimeIndex(matrix2['OfferingDate']).month
#%%
step = pd.merge(company, adjprices, left_on=['gvkey','iid'], right_on = ['gvkey','iid'],how='inner')
adjprices1 = step[['gvkey', 'iid', 'datadate', 'prccd_adj', 'cshtrd_adj']]
adjprices2 = adjprices1.pivot_table(index='gvkey',columns='datadate',values='prccd_adj')
adjreturn = adjprices1.pivot_table(index='datadate',columns='gvkey',values='prccd_adj')
adjreturn2 = adjreturn.pct_change()
gvkeys = list(adjreturn2.columns)
matrix2 = matrix2[matrix2['gvkey'].isin(gvkeys)]
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate']], axis=1)
volume = adjprices.pivot_table(index='datadate',columns='gvkey',values='cshtrd_adj')
volumechg = volume.pct_change()
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])

matrix2 = matrix2.rename(columns = {0:'tdreturn'})
matrix2 = matrix2.rename(columns = {1:'tdvolumechg'})
#%%
matrix2 = pd.merge(matrix2, mktcap.reset_index(), left_on=['companyid','OfferingDate'], right_on = ['companyid','pricingdate'])
del matrix2['pricingdate']
#%%
bday_us = CustomBusinessDay(calendar=USFederalHolidayCalendar())
matrix2['OfferingDate+1'] = matrix2['OfferingDate']+bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate+1']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate+1']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td+1return'})
matrix2 = matrix2.rename(columns = {1:'td+1volumechg'})

matrix2['OfferingDate+2'] = matrix2['OfferingDate+1']+bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate+2']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate+2']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td+2return'})
matrix2 = matrix2.rename(columns = {1:'td+2volumechg'})

matrix2['OfferingDate+3'] = matrix2['OfferingDate+2']+bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate+3']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate+3']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td+3return'})
matrix2 = matrix2.rename(columns = {1:'td+3volumechg'})

matrix2['OfferingDate+4'] = matrix2['OfferingDate+3']+bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate+4']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate+4']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td+4return'})
matrix2 = matrix2.rename(columns = {1:'td+4volumechg'})

matrix2['OfferingDate+5'] = matrix2['OfferingDate+4']+bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate+5']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate+5']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td+5return'})
matrix2 = matrix2.rename(columns = {1:'td+5volumechg'})

matrix2['OfferingDate-1'] = matrix2['OfferingDate']-bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate-1']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate-1']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td-1return'})
matrix2 = matrix2.rename(columns = {1:'td-1volumechg'})

matrix2['OfferingDate-2'] = matrix2['OfferingDate-1']-bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate-2']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate-2']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td-2return'})
matrix2 = matrix2.rename(columns = {1:'td-2volumechg'})

matrix2['OfferingDate-3'] = matrix2['OfferingDate-2']-bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate-3']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate-3']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td-3return'})
matrix2 = matrix2.rename(columns = {1:'td-3volumechg'})

matrix2['OfferingDate-4'] = matrix2['OfferingDate-3']-bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate-4']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate-4']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td-4return'})
matrix2 = matrix2.rename(columns = {1:'td-4volumechg'})

matrix2['OfferingDate-5'] = matrix2['OfferingDate-4']-bday_us
sample_return = matrix2.apply(lambda row: adjreturn2[row['gvkey']][row['OfferingDate-5']], axis=1)
sample_volumechg = matrix2.apply(lambda row: volumechg[row['gvkey']][row['OfferingDate-5']], axis=1)
matrix2 = pd.concat([matrix2, sample_return,sample_volumechg], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {0:'td-5return'})
matrix2 = matrix2.rename(columns = {1:'td-5volumechg'})
##matrix2 = pd.merge(matrix2, mktcap.reset_index(), left_on=['companyid','OfferingDate+1'], right_on = ['companyid','pricingdate'])
##del matrix2['pricingdate']
#%%
## add ISIN
##matrix2 = matrix2.set_index(['companyid'])
isin = symbol[(symbol['symboltypeid']==15) & (symbol['activeflag']==1)]
isin = isin.set_index(['companyid'])
##OfferingDate = '2015-05-24'
##mktcap2 = mktcap[(mktcap['pricingdate']==OfferingDate)]
##matrix2 = pd.concat([matrix2, mktcap2['pricingdate'],mktcap2['marketcap'],mktcap2['tev']], axis=1, join_axes=[matrix2.index])
matrix2 = matrix2.set_index(['companyid'])
matrix2 = pd.concat([matrix2,isin['symbolvalue']], axis=1, join_axes=[matrix2.index])
##matrix2 = pd.merge(matrix2, isin, left_on=['companyid'], right_on = ['companyid'])
matrix2 = matrix2.rename(columns = {'symbolvalue':'isin'})

#%% 
## add SEDOL
sedol = symbol[(symbol['symboltypeid']==5701) & (symbol['activeflag']==1)]
sedol = sedol.set_index(['companyid'])
matrix2 = pd.concat([matrix2, sedol['symbolvalue']], axis=1,join_axes=[matrix2.index])
matrix2 = matrix2.rename(columns = {'symbolvalue':'sedol'})
matrix2 = matrix2.reset_index()
#%%
##matrix2 = matrix2.dropna(subset=['sedol'])
##matrix2['testyear'] = matrix2['testyear'].astype(np.int64)
##matrix2['testmonth'] = matrix2['testmonth'].astype(np.int64)
matrix2 = pd.merge(matrix2, lifecycle, left_on=['companyid','testyear','testmonth'], right_on = ['ciqid','YEAR','MONTH'])
#%%
matrix2 = matrix2.set_index('OfferingDate').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'tdmktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate'})

matrix2 = matrix2.set_index('OfferingDate+1').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td+1mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate+1'})

matrix2 = matrix2.set_index('OfferingDate+2').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td+2mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate+2'})

matrix2 = matrix2.set_index('OfferingDate+3').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td+3mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate+3'})

matrix2 = matrix2.set_index('OfferingDate+4').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td+4mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate+4'})

matrix2 = matrix2.set_index('OfferingDate+5').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td+5mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate+5'})

matrix2 = matrix2.set_index('OfferingDate-1').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td-1mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate-1'})

matrix2 = matrix2.set_index('OfferingDate-2').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td-2mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate-2'})

matrix2 = matrix2.set_index('OfferingDate-3').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td-3mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate-3'})

matrix2 = matrix2.set_index('OfferingDate-4').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td-4mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate-4'})

matrix2 = matrix2.set_index('OfferingDate-5').join(spx.set_index('Date'))
matrix2 = matrix2.rename(columns = {'Return':'td-5mktret'})
matrix2 = matrix2.reset_index()
matrix2 = matrix2.rename(columns = {'index':'OfferingDate-5'})
##matrix2 = pd.merge(matrix2, spx, left_on=['OfferingDate'], right_on = ['IQ2668699'])
##del matrix2['IQ2668699']
##del matrix2['IQ_LASTSALEPRICE']
#%%
matrix2['tdidioret'] = matrix2[['tdreturn']].sub(matrix2['tdmktret'], axis=0)
matrix2['tdidioret+1'] = matrix2[['td+1return']].sub(matrix2['td+1mktret'], axis=0)
matrix2['tdidioret+2'] = matrix2[['td+2return']].sub(matrix2['td+2mktret'], axis=0)
matrix2['tdidioret+3'] = matrix2[['td+3return']].sub(matrix2['td+3mktret'], axis=0)
matrix2['tdidioret+4'] = matrix2[['td+4return']].sub(matrix2['td+4mktret'], axis=0)
matrix2['tdidioret+5'] = matrix2[['td+5return']].sub(matrix2['td+5mktret'], axis=0)

matrix2['tdidioret-1'] = matrix2[['td-1return']].sub(matrix2['td-1mktret'], axis=0)
matrix2['tdidioret-2'] = matrix2[['td-2return']].sub(matrix2['td-2mktret'], axis=0)
matrix2['tdidioret-3'] = matrix2[['td-3return']].sub(matrix2['td-3mktret'], axis=0)
matrix2['tdidioret-4'] = matrix2[['td-4return']].sub(matrix2['td-4mktret'], axis=0)
matrix2['tdidioret-5'] = matrix2[['td-5return']].sub(matrix2['td-5mktret'], axis=0)
##matrix2 = pd.concat([matrix2, fund['dataitemvalue'],fund['periodenddate'],fund['filingdate']], axis=1, join_axes=[matrix2.index])
##matrix2=matrix2.rename(columns = {'dataitemvalue':'netlev'})


##pandas.merge(mktcap_2.reset_index(), sample_df.reset_index(), left_on=['companyid','pricingdate'], right_on = ['companyid','date'])
#%%
matrix2['totidio+1'] = matrix2['tdidioret'] + matrix2['tdidioret+1']
matrix2['totidio+2'] = matrix2['totidio+1'] + matrix2['tdidioret+2']
matrix2['totidio+3'] = matrix2['totidio+2'] + matrix2['tdidioret+3']
matrix2['totidio+4'] = matrix2['totidio+3'] + matrix2['tdidioret+4']
matrix2['totidio+5'] = matrix2['totidio+4'] + matrix2['tdidioret+5']

matrix2['totidio-1'] = matrix2[['tdidioret']].sub(matrix2['tdidioret-1'], axis=0)
matrix2['totidio-2'] = matrix2[['totidio-1']].sub(matrix2['tdidioret-2'], axis=0)
matrix2['totidio-3'] = matrix2[['totidio-2']].sub(matrix2['tdidioret-3'], axis=0)
matrix2['totidio-4'] = matrix2[['totidio-3']].sub(matrix2['tdidioret-4'], axis=0)
matrix2['totidio-5'] = matrix2[['totidio-4']].sub(matrix2['tdidioret-5'], axis=0)

#%%
namatrix2 = matrix2[(matrix2['Domicile'] =='United States') | (matrix2['Domicile'] =='Canada')]
converts = namatrix2[(namatrix2['SecurityType'] =='Corporate Convertible')]
converts = converts.fillna(0)
converts1 = converts[(converts['LifeCode'] == 1)]
converts2 = converts[(converts['LifeCode'] == 2)]
converts3 = converts[(converts['LifeCode'] == 3)]
converts4 = converts[(converts['LifeCode'] == 4)]
converts5 = converts[(converts['LifeCode'] == 5)]
converts5ret = converts5[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
converts4ret = converts4[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
converts3ret = converts3[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
converts2ret = converts2[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
converts1ret = converts1[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]

stats.ttest_1samp(converts5ret,0)
stats.ttest_1samp(converts4ret,0)
stats.ttest_1samp(converts3ret,0)
stats.ttest_1samp(converts2ret,0)
stats.ttest_1samp(converts1ret,0)
#%%
corps = namatrix2[(namatrix2['SecurityType'] =='Corporate Debentures')|(namatrix2['SecurityType'] =='Corporate MTN')]
corps = corps.fillna(0)
corps1 = corps[(corps['LifeCode'] == 1)]
corps2 = corps[(corps['LifeCode'] == 2)]
corps3 = corps[(corps['LifeCode'] == 3)]
corps4 = corps[(corps['LifeCode'] == 4)]
corps5 = corps[(corps['LifeCode'] == 5)]
corps5ret = corps5[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
corps4ret = corps4[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
corps3ret = corps3[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
corps2ret = corps2[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]
corps1ret = corps1[['testyear','tdidioret','tdidioret+1', 'tdidioret+2', 'tdidioret+3', 'tdidioret+4','tdidioret+5', 'tdidioret-1', 'tdidioret-2', 'tdidioret-3','tdidioret-4', 'tdidioret-5', 'totidio+1', 'totidio+2', 'totidio+3', 'totidio+4','totidio+5', 'totidio-2', 'totidio-3', 'totidio-4', 'totidio-5']]



